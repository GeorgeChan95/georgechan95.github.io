<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>02-JUC进阶-CompletableFuture | George&#39;s Blog</title>
  <meta name="google-site-verification" content="RobLWkyyFziZxPJ4I887QROdX8XrYthcJwWTcuH0wwQ" />
  <meta name="msvalidate.01" content="626D541C48E5D151F52CECC2C6714BD4" />
  <meta name="360-site-verification" content="c838adf8357ca2f614d08ad5235a1717" />
  <meta name="keywords" content=" java , juc ">
  <meta name="description" content="02-JUC进阶-CompletableFuture | George&#39;s Blog">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="个人简介目前人在合肥，从事后端开发工作。 联系方式 邮箱：&#103;&#x65;&#x6f;&#114;&#x67;&#x65;&#x5f;&#x39;&#x35;&#64;&#x31;&#50;&#54;&#x2e;&#99;&#x6f;&#109;  邮件可能几天才看一次，如有联系，请耐心等待。">
<meta property="og:type" content="website">
<meta property="og:title" content="关于">
<meta property="og:url" content="https://georgechan95.github.io/about/index.html">
<meta property="og:site_name" content="George&#39;s Blog">
<meta property="og:description" content="个人简介目前人在合肥，从事后端开发工作。 联系方式 邮箱：&#103;&#x65;&#x6f;&#114;&#x67;&#x65;&#x5f;&#x39;&#x35;&#64;&#x31;&#50;&#54;&#x2e;&#99;&#x6f;&#109;  邮件可能几天才看一次，如有联系，请耐心等待。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-11-21T02:29:45.000Z">
<meta property="article:modified_time" content="2024-06-22T10:36:12.823Z">
<meta property="article:author" content="George">
<meta name="twitter:card" content="summary">


<link rel="icon" href="/img/favicon.png">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/sublime.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="George's Blog" type="application/atom+xml">
</head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/avatar.jpg"/>
</a>
<div class="author">
    <span>George</span>
</div>

<div class="icon">
    
        
            <a title="rss"
               href="/atom.xml"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-rss"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="github"
               href="https://github.com/GeorgeChan95"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-github"></use>
                    </svg>
                
            </a>
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
            <a title="email"
               href="mailto:george_95@126.com"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-email"></use>
                    </svg>
                
            </a>
        
    
        
    
        
    
        
    
</div>





<ul>
    <li>
        <div class="all active" data-rel="全部文章">全部文章
            
                <small>(82)</small>
            
        </div>
    </li>
    
        
            
                
    <li>
        <div data-rel="设计模式">
            
            设计模式
            <small>(14)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="算法">
            
            算法
            <small>(5)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="Hexo">
            <i class="fold iconfont icon-right"></i>
            Hexo
            <small>(5)</small>
        </div>
        
            <ul class="sub hide">
                
                    
    <li>
        <div data-rel="Hexo&lt;---&gt;Typora">
            
            Typora
            <small>(1)</small>
        </div>
        
    </li>

                
            </ul>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="JUC">
            
            JUC
            <small>(24)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="JVM">
            
            JVM
            <small>(27)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="linux">
            
            linux
            <small>(3)</small>
        </div>
        
    </li>

            
        
    
        
            
                
    <li>
        <div data-rel="neo4j">
            
            neo4j
            <small>(3)</small>
        </div>
        
    </li>

            
        
    
        
            
        
    
        
            
                
    <li>
        <div data-rel="UML">
            
            UML
            <small>(1)</small>
        </div>
        
    </li>

            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
            
    </div>
    <div>
        
            <a class="about  site_url"
               
               href="/about">关于</a>
        
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="82">
<input type="hidden" id="yelog_site_word_count" value="356.9k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        友情链接
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="http://yelog.org/">叶落阁</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="搜索 快捷键 i"></i>
            <div class="right-title">全部文章</div>
            <i class="iconfont icon-file-tree" data-title="切换到大纲视图 快捷键 w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="返回"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="大小写敏感"></i>
            <i class="iconfont icon-tag" data-title="标签"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">大纲</div>
            <i class="iconfont icon-list" data-title="切换到文章列表"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>插入排序</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>二分法</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>二进制</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>合并有序链表</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>链表</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>冒泡排序</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>设计模式</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>双亲委派机制</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>算法</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>位运算</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>选择排序</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>github</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>github pages</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>hexo</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>java</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>jenkins</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>juc</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>jvm</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>linux</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>neo4j</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>sitemap</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>SpringBoot</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>typora</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ubuntu18</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>UML</a>
            </li>
        
    </div>

</div>

    
    <nav id="title-list-nav">
        
        
        <a  class="全部文章 设计模式 "
           href="/blog/4930323d.html"
           data-tag="设计模式"
           data-author="" >
            <span class="post-title" title="15-模板方法模式">15-模板方法模式</span>
            <span class="post-date" title="2024-11-23 19:40:00">2024/11/23</span>
        </a>
        
        
        <a  class="全部文章 设计模式 "
           href="/blog/e4235185.html"
           data-tag="设计模式"
           data-author="" >
            <span class="post-title" title="14-代理模式">14-代理模式</span>
            <span class="post-date" title="2024-11-21 23:16:00">2024/11/21</span>
        </a>
        
        
        <a  class="全部文章 设计模式 "
           href="/blog/1b225c1f.html"
           data-tag="设计模式"
           data-author="" >
            <span class="post-title" title="13-享元模式">13-享元模式</span>
            <span class="post-date" title="2024-11-20 23:10:00">2024/11/20</span>
        </a>
        
        
        <a  class="全部文章 设计模式 "
           href="/blog/906e9e8b.html"
           data-tag="设计模式"
           data-author="" >
            <span class="post-title" title="12-外观模式">12-外观模式</span>
            <span class="post-date" title="2024-11-20 22:09:00">2024/11/20</span>
        </a>
        
        
        <a  class="全部文章 设计模式 "
           href="/blog/c456a66a.html"
           data-tag="设计模式"
           data-author="" >
            <span class="post-title" title="11-组合模式">11-组合模式</span>
            <span class="post-date" title="2024-11-16 17:00:00">2024/11/16</span>
        </a>
        
        
        <a  class="全部文章 设计模式 "
           href="/blog/90213fc6.html"
           data-tag="设计模式"
           data-author="" >
            <span class="post-title" title="10-装饰器模式">10-装饰器模式</span>
            <span class="post-date" title="2024-11-16 14:06:00">2024/11/16</span>
        </a>
        
        
        <a  class="全部文章 设计模式 "
           href="/blog/c7419cfa.html"
           data-tag="设计模式"
           data-author="" >
            <span class="post-title" title="09-桥接模式">09-桥接模式</span>
            <span class="post-date" title="2024-11-14 20:51:00">2024/11/14</span>
        </a>
        
        
        <a  class="全部文章 设计模式 "
           href="/blog/f77fc055.html"
           data-tag="设计模式"
           data-author="" >
            <span class="post-title" title="08-适配器模式">08-适配器模式</span>
            <span class="post-date" title="2024-11-12 22:55:00">2024/11/12</span>
        </a>
        
        
        <a  class="全部文章 neo4j "
           href="/blog/a3b0b090.html"
           data-tag="neo4j,SpringBoot"
           data-author="" >
            <span class="post-title" title="Spring Boot对Neo4j节点关系的增删改查">Spring Boot对Neo4j节点关系的增删改查</span>
            <span class="post-date" title="2024-11-12 21:00:30">2024/11/12</span>
        </a>
        
        
        <a  class="全部文章 设计模式 "
           href="/blog/3ab9aa56.html"
           data-tag="设计模式"
           data-author="" >
            <span class="post-title" title="07-建造者模式">07-建造者模式</span>
            <span class="post-date" title="2024-11-11 21:55:00">2024/11/11</span>
        </a>
        
        
        <a  class="全部文章 neo4j "
           href="/blog/7dc0fcde.html"
           data-tag="neo4j,SpringBoot"
           data-author="" >
            <span class="post-title" title="Spring Boot整合Neo4j实现增删改查">Spring Boot整合Neo4j实现增删改查</span>
            <span class="post-date" title="2024-11-07 19:04:30">2024/11/07</span>
        </a>
        
        
        <a  class="全部文章 设计模式 "
           href="/blog/564adc33.html"
           data-tag="设计模式"
           data-author="" >
            <span class="post-title" title="06-原型模式">06-原型模式</span>
            <span class="post-date" title="2024-11-06 19:00:00">2024/11/06</span>
        </a>
        
        
        <a  class="全部文章 设计模式 "
           href="/blog/effeea78.html"
           data-tag="设计模式"
           data-author="" >
            <span class="post-title" title="05-工厂模式">05-工厂模式</span>
            <span class="post-date" title="2024-11-04 21:00:00">2024/11/04</span>
        </a>
        
        
        <a  class="全部文章 设计模式 "
           href="/blog/d7e99843.html"
           data-tag="设计模式"
           data-author="" >
            <span class="post-title" title="04-单例模式">04-单例模式</span>
            <span class="post-date" title="2024-11-04 19:00:00">2024/11/04</span>
        </a>
        
        
        <a  class="全部文章 设计模式 "
           href="/blog/90f1850a.html"
           data-tag="设计模式,UML"
           data-author="" >
            <span class="post-title" title="03-UML类图">03-UML类图</span>
            <span class="post-date" title="2024-11-02 14:57:00">2024/11/02</span>
        </a>
        
        
        <a  class="全部文章 UML "
           href="/blog/c13304c1.html"
           data-tag="设计模式,UML"
           data-author="" >
            <span class="post-title" title="02-UML图绘制工具">02-UML图绘制工具</span>
            <span class="post-date" title="2024-11-02 09:57:00">2024/11/02</span>
        </a>
        
        
        <a  class="全部文章 linux "
           href="/blog/2e826df1.html"
           data-tag="linux,ubuntu18"
           data-author="" >
            <span class="post-title" title="Docker环境下RTSP流转RTMP和HLS">Docker环境下RTSP流转RTMP和HLS</span>
            <span class="post-date" title="2024-11-01 15:17:33">2024/11/01</span>
        </a>
        
        
        <a  class="全部文章 设计模式 "
           href="/blog/cd625bba.html"
           data-tag="设计模式,java"
           data-author="" >
            <span class="post-title" title="01-设计模式六大原则">01-设计模式六大原则</span>
            <span class="post-date" title="2024-10-31 17:00:00">2024/10/31</span>
        </a>
        
        
        <a  class="全部文章 JUC "
           href="/blog/1a649f4c.html"
           data-tag="java,juc"
           data-author="" >
            <span class="post-title" title="13-JUC进阶-ReentrantReadWriteLock与StampedLock">13-JUC进阶-ReentrantReadWriteLock与StampedLock</span>
            <span class="post-date" title="2024-10-19 09:26:00">2024/10/19</span>
        </a>
        
        
        <a  class="全部文章 neo4j "
           href="/blog/5c93903a.html"
           data-tag="linux,neo4j"
           data-author="" >
            <span class="post-title" title="Docker部署Neo4j并导入CSV数据">Docker部署Neo4j并导入CSV数据</span>
            <span class="post-date" title="2024-10-17 15:00:30">2024/10/17</span>
        </a>
        
        
        <a  class="全部文章 linux "
           href="/blog/ad38e6b1.html"
           data-tag="linux,ubuntu18"
           data-author="" >
            <span class="post-title" title="Ubuntu18.04离线源环境搭建">Ubuntu18.04离线源环境搭建</span>
            <span class="post-date" title="2024-10-17 09:47:33">2024/10/17</span>
        </a>
        
        
        <a  class="全部文章 JUC "
           href="/blog/3fdbf0f6.html"
           data-tag="java,juc"
           data-author="" >
            <span class="post-title" title="12-JUC进阶-从ReentrantLock到AQS源码详解">12-JUC进阶-从ReentrantLock到AQS源码详解</span>
            <span class="post-date" title="2024-10-15 19:42:07">2024/10/15</span>
        </a>
        
        
        <a  class="全部文章 JUC "
           href="/blog/3e0d7592.html"
           data-tag="java,juc"
           data-author="" >
            <span class="post-title" title="11-JUC进阶-Synchronized与锁升级">11-JUC进阶-Synchronized与锁升级</span>
            <span class="post-date" title="2024-10-06 09:28:00">2024/10/06</span>
        </a>
        
        
        <a  class="全部文章 JUC "
           href="/blog/4502cffa.html"
           data-tag="java,juc"
           data-author="" >
            <span class="post-title" title="10-JUC进阶-Java对象内存布局和对象头">10-JUC进阶-Java对象内存布局和对象头</span>
            <span class="post-date" title="2024-10-04 09:54:40">2024/10/04</span>
        </a>
        
        
        <a  class="全部文章 JUC "
           href="/blog/4de6a39b.html"
           data-tag="java,juc"
           data-author="" >
            <span class="post-title" title="09-JUC进阶-ThreadLocal">09-JUC进阶-ThreadLocal</span>
            <span class="post-date" title="2024-10-01 20:39:10">2024/10/01</span>
        </a>
        
        
        <a  class="全部文章 JUC "
           href="/blog/72329cf5.html"
           data-tag="java,juc"
           data-author="" >
            <span class="post-title" title="08-JUC进阶-常用的原子操作类(18个)">08-JUC进阶-常用的原子操作类(18个)</span>
            <span class="post-date" title="2024-09-28 13:37:09">2024/09/28</span>
        </a>
        
        
        <a  class="全部文章 JUC "
           href="/blog/5e3757c1.html"
           data-tag="java,juc"
           data-author="" >
            <span class="post-title" title="07-JUC进阶-CAS">07-JUC进阶-CAS</span>
            <span class="post-date" title="2024-09-26 19:37:00">2024/09/26</span>
        </a>
        
        
        <a  class="全部文章 JUC "
           href="/blog/546d628d.html"
           data-tag="java,juc"
           data-author="" >
            <span class="post-title" title="06-JUC进阶-Volatile与Java内存模型">06-JUC进阶-Volatile与Java内存模型</span>
            <span class="post-date" title="2024-09-25 19:01:01">2024/09/25</span>
        </a>
        
        
        <a  class="全部文章 JUC "
           href="/blog/1f2e0014.html"
           data-tag="java,juc"
           data-author="" >
            <span class="post-title" title="05-JUC进阶-Java内存模型-JMM">05-JUC进阶-Java内存模型-JMM</span>
            <span class="post-date" title="2024-09-23 23:01:07">2024/09/23</span>
        </a>
        
        
        <a  class="全部文章 JUC "
           href="/blog/19653fb9.html"
           data-tag="java,juc"
           data-author="" >
            <span class="post-title" title="04-JUC进阶-LockSupport与线程中断">04-JUC进阶-LockSupport与线程中断</span>
            <span class="post-date" title="2024-09-23 20:51:50">2024/09/23</span>
        </a>
        
        
        <a  class="全部文章 JUC "
           href="/blog/219e52ea.html"
           data-tag="java,juc"
           data-author="" >
            <span class="post-title" title="03-JUC进阶-Java中的锁的解析">03-JUC进阶-Java中的锁的解析</span>
            <span class="post-date" title="2024-09-21 14:15:20">2024/09/21</span>
        </a>
        
        
        <a  class="全部文章 JUC "
           href="/blog/7e2d78eb.html"
           data-tag="java,juc"
           data-author="" >
            <span class="post-title" title="02-JUC进阶-CompletableFuture">02-JUC进阶-CompletableFuture</span>
            <span class="post-date" title="2024-09-18 22:50:00">2024/09/18</span>
        </a>
        
        
        <a  class="全部文章 JUC "
           href="/blog/3d102971.html"
           data-tag="java,juc"
           data-author="" >
            <span class="post-title" title="01-JUC进阶-线程基础">01-JUC进阶-线程基础</span>
            <span class="post-date" title="2024-09-18 22:32:00">2024/09/18</span>
        </a>
        
        
        <a  class="全部文章 JUC "
           href="/blog/37d56d14.html"
           data-tag="java,juc"
           data-author="" >
            <span class="post-title" title="11-CompletableFuture">11-CompletableFuture</span>
            <span class="post-date" title="2024-09-16 16:12:00">2024/09/16</span>
        </a>
        
        
        <a  class="全部文章 JUC "
           href="/blog/31919959.html"
           data-tag="java,juc"
           data-author="" >
            <span class="post-title" title="10-Fork/Join">10-Fork/Join</span>
            <span class="post-date" title="2024-09-16 13:10:00">2024/09/16</span>
        </a>
        
        
        <a  class="全部文章 JUC "
           href="/blog/a0197c15.html"
           data-tag="java,juc"
           data-author="" >
            <span class="post-title" title="09-ThreadPool-线程池">09-ThreadPool-线程池</span>
            <span class="post-date" title="2024-09-13 20:10:08">2024/09/13</span>
        </a>
        
        
        <a  class="全部文章 JUC "
           href="/blog/a6760d1f.html"
           data-tag="java,juc"
           data-author="" >
            <span class="post-title" title="08-阻塞队列BlockingQueue">08-阻塞队列BlockingQueue</span>
            <span class="post-date" title="2024-09-07 17:30:00">2024/09/07</span>
        </a>
        
        
        <a  class="全部文章 JUC "
           href="/blog/838e7581.html"
           data-tag="java,juc"
           data-author="" >
            <span class="post-title" title="07-JUC辅助类CountDownLatch、CyclicBarrier、Semaphore">07-JUC辅助类CountDownLatch、CyclicBarrier、Semaphore</span>
            <span class="post-date" title="2024-09-07 13:00:00">2024/09/07</span>
        </a>
        
        
        <a  class="全部文章 JUC "
           href="/blog/f60e37c5.html"
           data-tag="java,juc"
           data-author="" >
            <span class="post-title" title="06-Callable &amp; Future 接口">06-Callable &amp; Future 接口</span>
            <span class="post-date" title="2024-09-06 22:10:00">2024/09/06</span>
        </a>
        
        
        <a  class="全部文章 JUC "
           href="/blog/f184587f.html"
           data-tag="java,juc"
           data-author="" >
            <span class="post-title" title="05-公平锁和非公平锁，死锁，可重入锁">05-公平锁和非公平锁，死锁，可重入锁</span>
            <span class="post-date" title="2024-09-05 20:12:00">2024/09/05</span>
        </a>
        
        
        <a  class="全部文章 JUC "
           href="/blog/9a09d992.html"
           data-tag="java,juc"
           data-author="" >
            <span class="post-title" title="04-集合的线程安全">04-集合的线程安全</span>
            <span class="post-date" title="2024-09-04 21:09:05">2024/09/04</span>
        </a>
        
        
        <a  class="全部文章 JUC "
           href="/blog/bd2134da.html"
           data-tag="java,juc"
           data-author="" >
            <span class="post-title" title="03-线程间通信">03-线程间通信</span>
            <span class="post-date" title="2024-09-04 20:06:00">2024/09/04</span>
        </a>
        
        
        <a  class="全部文章 JUC "
           href="/blog/850dac3c.html"
           data-tag="java,juc"
           data-author="" >
            <span class="post-title" title="02-Lock接口">02-Lock接口</span>
            <span class="post-date" title="2024-08-30 19:27:00">2024/08/30</span>
        </a>
        
        
        <a  class="全部文章 JUC "
           href="/blog/4e6bd685.html"
           data-tag="java,juc"
           data-author="" >
            <span class="post-title" title="01-多线程的基本概念">01-多线程的基本概念</span>
            <span class="post-date" title="2024-08-30 19:03:01">2024/08/30</span>
        </a>
        
        
        <a  class="全部文章 JVM "
           href="/blog/1b0522f4.html"
           data-tag="java,jvm"
           data-author="" >
            <span class="post-title" title="第二十五章-分析GC日志">第二十五章-分析GC日志</span>
            <span class="post-date" title="2024-08-28 21:36:08">2024/08/28</span>
        </a>
        
        
        <a  class="全部文章 JVM "
           href="/blog/944806143.html"
           data-tag="java,jvm"
           data-author="" >
            <span class="post-title" title="第二十四章-JVM运行时参数">第二十四章-JVM运行时参数</span>
            <span class="post-date" title="2024-08-27 18:30:10">2024/08/27</span>
        </a>
        
        
        <a  class="全部文章 JVM "
           href="/blog/490498600.html"
           data-tag="java,jvm"
           data-author="" >
            <span class="post-title" title="第二十三章-使用OQL语言查询对象信息">第二十三章-使用OQL语言查询对象信息</span>
            <span class="post-date" title="2024-08-24 15:02:10">2024/08/24</span>
        </a>
        
        
        <a  class="全部文章 JVM "
           href="/blog/1471620196.html"
           data-tag="java,jvm"
           data-author="" >
            <span class="post-title" title="第二十三章-浅堆-深堆-内存泄漏">第二十三章-浅堆-深堆-内存泄漏</span>
            <span class="post-date" title="2024-08-24 13:04:37">2024/08/24</span>
        </a>
        
        
        <a  class="全部文章 JVM "
           href="/blog/971417975.html"
           data-tag="java,jvm"
           data-author="" >
            <span class="post-title" title="第二十三章-JVM监控及诊断工具-GUI篇">第二十三章-JVM监控及诊断工具-GUI篇</span>
            <span class="post-date" title="2024-08-16 21:00:00">2024/08/16</span>
        </a>
        
        
        <a  class="全部文章 JVM "
           href="/blog/2165702380.html"
           data-tag="java,jvm"
           data-author="" >
            <span class="post-title" title="第二十二章-JVM监控及诊断工具-命令行篇">第二十二章-JVM监控及诊断工具-命令行篇</span>
            <span class="post-date" title="2024-08-12 19:36:32">2024/08/12</span>
        </a>
        
        
        <a  class="全部文章 JVM "
           href="/blog/2681163762.html"
           data-tag="java,jvm"
           data-author="" >
            <span class="post-title" title="第二十一章-性能监控与调优概述">第二十一章-性能监控与调优概述</span>
            <span class="post-date" title="2024-08-12 19:13:06">2024/08/12</span>
        </a>
        
        
        <a  class="全部文章 JVM "
           href="/blog/3537043756.html"
           data-tag="java,jvm"
           data-author="" >
            <span class="post-title" title="第二十章-再谈类的加载器">第二十章-再谈类的加载器</span>
            <span class="post-date" title="2024-08-10 13:43:10">2024/08/10</span>
        </a>
        
        
        <a  class="全部文章 JVM "
           href="/blog/3387211378.html"
           data-tag="java,jvm"
           data-author="" >
            <span class="post-title" title="第十九章-类的加载过程详解">第十九章-类的加载过程详解</span>
            <span class="post-date" title="2024-08-02 19:33:27">2024/08/02</span>
        </a>
        
        
        <a  class="全部文章 JVM "
           href="/blog/1107503247.html"
           data-tag="java,jvm"
           data-author="" >
            <span class="post-title" title="第十八章-字节码指令集与解析指令">第十八章-字节码指令集与解析指令</span>
            <span class="post-date" title="2024-08-01 01:40:02">2024/08/01</span>
        </a>
        
        
        <a  class="全部文章 JVM "
           href="/blog/2772873157.html"
           data-tag="java,jvm"
           data-author="" >
            <span class="post-title" title="第十七章-使用javap指令解析class文件">第十七章-使用javap指令解析class文件</span>
            <span class="post-date" title="2024-07-22 23:54:00">2024/07/22</span>
        </a>
        
        
        <a  class="全部文章 JVM "
           href="/blog/143162370.html"
           data-tag="java,jvm"
           data-author="" >
            <span class="post-title" title="第十六章-Class文件结构">第十六章-Class文件结构</span>
            <span class="post-date" title="2024-07-15 19:54:50">2024/07/15</span>
        </a>
        
        
        <a  class="全部文章 JVM "
           href="/blog/309245330.html"
           data-tag="java,jvm"
           data-author="" >
            <span class="post-title" title="第十五章-GC日志分析">第十五章-GC日志分析</span>
            <span class="post-date" title="2024-07-13 08:34:00">2024/07/13</span>
        </a>
        
        
        <a  class="全部文章 JVM "
           href="/blog/1750792302.html"
           data-tag="java,jvm"
           data-author="" >
            <span class="post-title" title="第十四章-垃圾收集器">第十四章-垃圾收集器</span>
            <span class="post-date" title="2024-07-10 19:27:00">2024/07/10</span>
        </a>
        
        
        <a  class="全部文章 算法 "
           href="/blog/484946532.html"
           data-tag="算法,合并有序链表"
           data-author="" >
            <span class="post-title" title="合并两个有序链表">合并两个有序链表</span>
            <span class="post-date" title="2024-07-06 09:11:00">2024/07/06</span>
        </a>
        
        
        <a  class="全部文章 算法 "
           href="/blog/2929260443.html"
           data-tag="算法,链表"
           data-author="" >
            <span class="post-title" title="链表反转">链表反转</span>
            <span class="post-date" title="2024-07-05 19:45:45">2024/07/05</span>
        </a>
        
        
        <a  class="全部文章 算法 "
           href="/blog/1403776474.html"
           data-tag="算法,选择排序,冒泡排序,插入排序"
           data-author="" >
            <span class="post-title" title="选择-冒泡-插入排序">选择-冒泡-插入排序</span>
            <span class="post-date" title="2024-07-03 11:02:16">2024/07/03</span>
        </a>
        
        
        <a  class="全部文章 算法 "
           href="/blog/2561891005.html"
           data-tag="算法,二分法"
           data-author="" >
            <span class="post-title" title="二分搜索">二分搜索</span>
            <span class="post-date" title="2024-06-29 10:04:10">2024/06/29</span>
        </a>
        
        
        <a  class="全部文章 算法 "
           href="/blog/2224151177.html"
           data-tag="算法,二进制,位运算"
           data-author="" >
            <span class="post-title" title="二进制和位运算">二进制和位运算</span>
            <span class="post-date" title="2024-06-20 08:04:00">2024/06/20</span>
        </a>
        
        
        <a  class="全部文章 JVM "
           href="/blog/2105268063.html"
           data-tag="java,jvm"
           data-author="" >
            <span class="post-title" title="第十三章-垃圾回收相关概念">第十三章-垃圾回收相关概念</span>
            <span class="post-date" title="2024-01-14 14:27:00">2024/01/14</span>
        </a>
        
        
        <a  class="全部文章 JVM "
           href="/blog/364508352.html"
           data-tag="java,jvm"
           data-author="" >
            <span class="post-title" title="第十二章-垃圾回收概述和相关算法">第十二章-垃圾回收概述和相关算法</span>
            <span class="post-date" title="2024-01-06 16:28:00">2024/01/06</span>
        </a>
        
        
        <a  class="全部文章 linux "
           href="/blog/2050535563.html"
           data-tag="linux,jenkins"
           data-author="" >
            <span class="post-title" title="Jenkins的安装和搭建自动化部署平台">Jenkins的安装和搭建自动化部署平台</span>
            <span class="post-date" title="2024-01-05 16:00:00">2024/01/05</span>
        </a>
        
        
        <a  class="全部文章 JVM "
           href="/blog/2388209687.html"
           data-tag="java,jvm"
           data-author="" >
            <span class="post-title" title="第十一章-StringTable(字符串常量池)">第十一章-StringTable(字符串常量池)</span>
            <span class="post-date" title="2023-12-25 17:27:06">2023/12/25</span>
        </a>
        
        
        <a  class="全部文章 JVM "
           href="/blog/3385856233.html"
           data-tag="java,jvm"
           data-author="" >
            <span class="post-title" title="第十章-执行引擎">第十章-执行引擎</span>
            <span class="post-date" title="2023-12-23 20:03:00">2023/12/23</span>
        </a>
        
        
        <a  class="全部文章 JVM "
           href="/blog/4075763684.html"
           data-tag="java,jvm"
           data-author="" >
            <span class="post-title" title="第九章-对象的实例化内存布局与访问定位">第九章-对象的实例化内存布局与访问定位</span>
            <span class="post-date" title="2023-12-21 11:50:00">2023/12/21</span>
        </a>
        
        
        <a  class="全部文章 JVM "
           href="/blog/3720767522.html"
           data-tag="java,jvm"
           data-author="" >
            <span class="post-title" title="第八章-直接内存">第八章-直接内存</span>
            <span class="post-date" title="2023-12-20 17:03:00">2023/12/20</span>
        </a>
        
        
        <a  class="全部文章 JVM "
           href="/blog/105864584.html"
           data-tag="java,jvm"
           data-author="" >
            <span class="post-title" title="第七章-方法区">第七章-方法区</span>
            <span class="post-date" title="2023-12-14 18:24:00">2023/12/14</span>
        </a>
        
        
        <a  class="全部文章 JVM "
           href="/blog/543408063.html"
           data-tag="java,jvm"
           data-author="" >
            <span class="post-title" title="第六章-JVM堆">第六章-JVM堆</span>
            <span class="post-date" title="2023-12-02 08:01:00">2023/12/02</span>
        </a>
        
        
        <a  class="全部文章 JVM "
           href="/blog/554039338.html"
           data-tag="java,jvm"
           data-author="" >
            <span class="post-title" title="第五章-本地方法接口">第五章-本地方法接口</span>
            <span class="post-date" title="2023-11-30 17:55:00">2023/11/30</span>
        </a>
        
        
        <a  class="全部文章 JVM "
           href="/blog/1123461525.html"
           data-tag="java,jvm"
           data-author="" >
            <span class="post-title" title="第四章-虚拟机栈">第四章-虚拟机栈</span>
            <span class="post-date" title="2023-11-28 20:55:00">2023/11/28</span>
        </a>
        
        
        <a  class="全部文章 JVM "
           href="/blog/1626061462.html"
           data-tag="java,jvm"
           data-author="" >
            <span class="post-title" title="第三章-运行时数据区">第三章-运行时数据区</span>
            <span class="post-date" title="2023-11-28 19:31:00">2023/11/28</span>
        </a>
        
        
        <a  class="全部文章 JVM "
           href="/blog/222077543.html"
           data-tag="java,jvm,双亲委派机制"
           data-author="" >
            <span class="post-title" title="第二章-JVM类加载子系统">第二章-JVM类加载子系统</span>
            <span class="post-date" title="2023-11-25 14:35:00">2023/11/25</span>
        </a>
        
        
        <a  class="全部文章 JVM "
           href="/blog/1897413233.html"
           data-tag="java,jvm"
           data-author="" >
            <span class="post-title" title="第一章-JVM和Java体系结构">第一章-JVM和Java体系结构</span>
            <span class="post-date" title="2023-11-25 10:00:00">2023/11/25</span>
        </a>
        
        
        <a  class="全部文章 Hexo "
           href="/blog/4179015178.html"
           data-tag="hexo,github pages,sitemap"
           data-author="" >
            <span class="post-title" title="给博客网站添加站点地图-sitemap">给博客网站添加站点地图-sitemap</span>
            <span class="post-date" title="2023-11-21 20:00:00">2023/11/21</span>
        </a>
        
        
        <a  class="全部文章 Hexo Typora "
           href="/blog/877664098.html"
           data-tag="hexo,typora,github"
           data-author="" >
            <span class="post-title" title="Typora设置图片自动上传Github">Typora设置图片自动上传Github</span>
            <span class="post-date" title="2023-11-20 20:30:00">2023/11/20</span>
        </a>
        
        
        <a  class="全部文章 Hexo "
           href="/blog/3069199997.html"
           data-tag="hexo,github pages"
           data-author="" >
            <span class="post-title" title="Hexo主题常用配置">Hexo主题常用配置</span>
            <span class="post-date" title="2023-11-20 00:00:01">2023/11/20</span>
        </a>
        
        
        <a  class="全部文章 Hexo "
           href="/blog/2016918085.html"
           data-tag="hexo,github pages"
           data-author="" >
            <span class="post-title" title="Hexo博客安装主题">Hexo博客安装主题</span>
            <span class="post-date" title="2023-11-20 00:00:01">2023/11/20</span>
        </a>
        
        
        <a  class="全部文章 Hexo "
           href="/blog/3070587776.html"
           data-tag="hexo,github pages"
           data-author="" >
            <span class="post-title" title="基于Hexo和Github Pages搭建个人博客">基于Hexo和Github Pages搭建个人博客</span>
            <span class="post-date" title="2023-11-18 15:40:20">2023/11/18</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="切换全屏 快捷键 s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-juc2/02-JUC进阶-CompletableFuture" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">02-JUC进阶-CompletableFuture</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="JUC">JUC</a>
            
        </span>
        
        
        <span class="tag">
            <i class="iconfont icon-tag"></i>
            
            <a class="color5">java</a>
            
            <a class="color4">juc</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
            发布时间 : <time class="date" title='最后更新: 2024-09-20 20:20:12'>2024-09-18 22:50</time>
        
    </div>
    <div class="article-meta">
        
        <span>字数:6.9k</span>
        
        
        <span id="busuanzi_container_page_pv">
            阅读 :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
        <span class="top-comment" title="跳转至评论区">
            <a href="#comments">
                评论:<span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </a>
        </span>
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81Future%E6%8E%A5%E5%8F%A3%E6%A6%82%E8%BF%B0"><span class="toc-text">一、Future接口概述</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81Future%E6%8E%A5%E5%8F%A3%E5%AE%9E%E7%8E%B0%E7%B1%BBFutureTask"><span class="toc-text">二、Future接口实现类FutureTask</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Future%E6%8E%A5%E5%8F%A3%E8%83%BD%E5%B9%B2%E4%BB%80%E4%B9%88"><span class="toc-text">1. Future接口能干什么</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Future%E6%8E%A5%E5%8F%A3%E7%9B%B8%E5%85%B3%E6%9E%B6%E6%9E%84"><span class="toc-text">2. Future接口相关架构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Future%E7%BC%96%E7%A0%81%E5%AE%9E%E6%88%98%E5%92%8C%E4%BC%98%E7%BC%BA%E7%82%B9%E5%88%86%E6%9E%90"><span class="toc-text">3. Future编码实战和优缺点分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%AE%8C%E6%88%90%E5%A4%8D%E6%9D%82%E7%9A%84%E4%BB%BB%E5%8A%A1"><span class="toc-text">4. 完成复杂的任务</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81CompletableFuture%E5%AF%B9Future%E7%9A%84%E6%94%B9%E8%BF%9B"><span class="toc-text">三、CompletableFuture对Future的改进</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-CompletableFuture%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BC%9A%E5%87%BA%E7%8E%B0"><span class="toc-text">1. CompletableFuture为什么会出现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-CompletableFuture-%E5%92%8C-CompletionStage-%E4%BB%8B%E7%BB%8D"><span class="toc-text">2. CompletableFuture 和 CompletionStage 介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%9B%9B%E4%B8%AA%E6%A0%B8%E5%BF%83%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95%EF%BC%8C%E5%88%9B%E5%BB%BA%E5%BC%82%E6%AD%A5%E4%BB%BB%E5%8A%A1"><span class="toc-text">3. 四个核心静态方法，创建异步任务</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E5%9B%9B%E4%B8%AA%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95%E6%BC%94%E7%A4%BA"><span class="toc-text">3.1 四个静态方法演示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E5%9B%9E%E8%B0%83%E6%96%B9%E6%B3%95%E6%BC%94%E7%A4%BA"><span class="toc-text">3.2 回调方法演示</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B"><span class="toc-text">四、函数式编程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%87%BD%E6%95%B0%E5%BC%8F%E6%8E%A5%E5%8F%A3"><span class="toc-text">1. 函数式接口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E9%93%BE%E5%BC%8F%E7%BC%96%E7%A8%8B"><span class="toc-text">2. 链式编程</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%94%E3%80%81join-%E5%92%8C-get-%E5%AF%B9%E6%AF%94"><span class="toc-text">五、join 和 get 对比</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AD%E3%80%81CompletableFuture-%E6%A1%88%E4%BE%8B%E8%AE%B2%E8%A7%A3"><span class="toc-text">六、CompletableFuture 案例讲解</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E9%9C%80%E6%B1%82%E8%AF%B4%E6%98%8E"><span class="toc-text">1. 需求说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E4%B8%8D%E4%BD%BF%E7%94%A8%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%AE%9E%E7%8E%B0%E9%9C%80%E6%B1%82"><span class="toc-text">2. 不使用多线程实现需求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E4%BD%BF%E7%94%A8-CompletableFuture-%E5%AE%9E%E7%8E%B0%E9%9C%80%E6%B1%82"><span class="toc-text">3. 使用 CompletableFuture 实现需求</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%83%E3%80%81CompletableFuture-%E5%B8%B8%E7%94%A8API"><span class="toc-text">七、CompletableFuture 常用API</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E8%8E%B7%E5%BE%97%E7%BB%93%E6%9E%9C%E5%92%8C%E8%A7%A6%E5%8F%91%E8%AE%A1%E7%AE%97"><span class="toc-text">1.获得结果和触发计算</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%AF%B9%E8%AE%A1%E7%AE%97%E7%BB%93%E6%9E%9C%E8%BF%9B%E8%A1%8C%E5%A4%84%E7%90%86"><span class="toc-text">2. 对计算结果进行处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%AF%B9%E8%AE%A1%E7%AE%97%E7%BB%93%E6%9E%9C%E8%BF%9B%E8%A1%8C%E6%B6%88%E8%B4%B9"><span class="toc-text">3. 对计算结果进行消费</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-CompleteFuture%E5%92%8C%E7%BA%BF%E7%A8%8B%E6%B1%A0%E8%AF%B4%E6%98%8E%EF%BC%88%E9%9D%9E%E5%B8%B8%E9%87%8D%E8%A6%81%EF%BC%89"><span class="toc-text">4. CompleteFuture和线程池说明（非常重要）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E5%AF%B9%E8%AE%A1%E7%AE%97%E9%80%9F%E5%BA%A6%E8%BF%9B%E8%A1%8C%E9%80%89%E7%94%A8"><span class="toc-text">5. 对计算速度进行选用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E5%AF%B9%E8%AE%A1%E7%AE%97%E7%BB%93%E6%9E%9C%E8%BF%9B%E8%A1%8C%E5%90%88%E5%B9%B6"><span class="toc-text">6. 对计算结果进行合并</span></a></li></ol></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="一、Future接口概述"><a href="#一、Future接口概述" class="headerlink" title="一、Future接口概述"></a>一、Future接口概述</h1><p>Future接口（FutureTask实现类）定义了操作异步任务执行一些方法，如获取异步任务的执行结果、取消异步任务的执行、判断任务是否被取消、判断任务执行是否完毕等。</p>
<p>举例：比如主线程让一个子线程去执行任务，子线程可能比较耗时，启动子线程开始执行任务后，主线程就去做其他事情了，忙完其他事情或者先执行完，过了一会再才去获取子任务的执行结果或变更的任务状态。</p>
<h1 id="二、Future接口实现类FutureTask"><a href="#二、Future接口实现类FutureTask" class="headerlink" title="二、Future接口实现类FutureTask"></a>二、Future接口实现类FutureTask</h1><h2 id="1-Future接口能干什么"><a href="#1-Future接口能干什么" class="headerlink" title="1. Future接口能干什么"></a>1. Future接口能干什么</h2><p>Future是 Java5 新加的一个接口，它提供一种异步并行计算的功能，如果主线程需要执行一个很耗时的计算任务，我们会就可以通过Future把这个任务放进异步线程中执行，主线程继续处理其他任务或者先行结束，再通过Future获取计算结果。</p>
<p>Future接口定义了操作异步任务执行一些方法，如获取异步任务的执行结果、取消任务的执行、判断任务是否被取消、判断任务执行是否完毕等。</p>
<h2 id="2-Future接口相关架构"><a href="#2-Future接口相关架构" class="headerlink" title="2. Future接口相关架构"></a>2. Future接口相关架构</h2><p><img src="https://raw.githubusercontent.com/GeorgeChan95/blogimg/master/img/2024/09/18/20240918-171237.png" alt="Future接口架构"></p>
<ul>
<li><p>目的：异步多线程任务执行且返回有结果，三个特点：多线程、有返回、异步任务（班长为老师去买水作为新启动的异步多线程任务且买到水有结果返回）</p>
</li>
<li><p>代码实现：Runnable接口+Callable接口+Future接口和FutureTask实现类。</p>
<pre><code class="highlight java"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FutureTaskDemo3</span> &#123;
    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ExecutionException, InterruptedException &#123;
        FutureTask&lt;String&gt; futureTask = <span class="keyword">new</span> <span class="title class_">FutureTask</span>&lt;&gt;(<span class="keyword">new</span> <span class="title class_">MyThread</span>());
        <span class="type">Thread</span> <span class="variable">thread</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(futureTask, <span class="string">&quot;t1&quot;</span>);
        <span class="comment">// 启动一个新的线程</span>
        thread.start();

        System.out.println(futureTask.get());
    &#125;
&#125;

<span class="keyword">class</span> <span class="title class_">MyThread</span> <span class="keyword">implements</span> <span class="title class_">Callable</span>&lt;String&gt; &#123;

    <span class="meta">@Override</span>
    <span class="keyword">public</span> String <span class="title function_">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;
        System.out.println(Thread.currentThread().getName() + <span class="string">&quot; come in ......&quot;</span>);
        <span class="keyword">return</span> <span class="string">&quot;Hello Callable&quot;</span>;
    &#125;
&#125;</code></pre></li>
</ul>
<h2 id="3-Future编码实战和优缺点分析"><a href="#3-Future编码实战和优缺点分析" class="headerlink" title="3. Future编码实战和优缺点分析"></a>3. Future编码实战和优缺点分析</h2><p><strong>优点</strong></p>
<p>Future+线程池异步多线程任务配合，能显著提高程序的运行效率。</p>
<p><strong>缺点</strong></p>
<ul>
<li>get() 阻塞—一旦调用get()方法求结果，一旦调用不见不散，非要等到结果才会离开，不管你是否计算完成，如果没有计算完成容易程序堵塞。</li>
</ul>
  <pre><code class="highlight java"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FutureTaskDemo1</span> &#123;
    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ExecutionException, InterruptedException, TimeoutException &#123;
        FutureTask&lt;String&gt; futureTask = <span class="keyword">new</span> <span class="title class_">FutureTask</span>&lt;&gt;(() -&gt; &#123;
            System.out.println(<span class="string">&quot;-----come in FutureTask&quot;</span>);
            <span class="keyword">try</span> &#123;
                TimeUnit.SECONDS.sleep(<span class="number">3</span>);
            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;
                e.printStackTrace();
            &#125;
            <span class="keyword">return</span> <span class="string">&quot;&quot;</span> + ThreadLocalRandom.current().nextInt(<span class="number">100</span>);
        &#125;);

        <span class="type">Thread</span> <span class="variable">t1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(futureTask, <span class="string">&quot;t1&quot;</span>);
        t1.start();

        <span class="comment">//3秒钟后才出来结果，还没有计算你提前来拿(只要一调用get方法，对于结果就是不见不散，会导致阻塞)</span>
        <span class="comment">//System.out.println(Thread.currentThread().getName()+&quot;\t&quot;+futureTask.get());</span>

        <span class="comment">//3秒钟后才出来结果，我只想等待1秒钟，过时不候</span>
        System.out.println(Thread.currentThread().getName() + <span class="string">&quot;\t&quot;</span> + futureTask.get(<span class="number">1L</span>, TimeUnit.SECONDS));

        System.out.println(Thread.currentThread().getName() + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot; run... here&quot;</span>);

    &#125;
&#125;</code></pre>

<ul>
<li>isDone() 轮询—轮询的方式会耗费无谓的cpu资源，而且也不见得能及时得到计算结果，如果想要异步获取结果，通常会以轮询的方式去获取结果，尽量不要阻塞。</li>
</ul>
  <pre><code class="highlight java"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FutureTaskDemo2</span> &#123;
    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ExecutionException, InterruptedException &#123;
        FutureTask&lt;String&gt; futureTask = <span class="keyword">new</span> <span class="title class_">FutureTask</span>&lt;&gt;(() -&gt; &#123;
            System.out.println(<span class="string">&quot;-----come in FutureTask&quot;</span>);
            <span class="keyword">try</span> &#123;
                TimeUnit.SECONDS.sleep(<span class="number">3</span>);
            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;
                e.printStackTrace();
            &#125;
            <span class="keyword">return</span> <span class="string">&quot;&quot;</span> + ThreadLocalRandom.current().nextInt(<span class="number">100</span>);
        &#125;);

        <span class="keyword">new</span> <span class="title class_">Thread</span>(futureTask, <span class="string">&quot;t1&quot;</span>).start();

        System.out.println(Thread.currentThread().getName() + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;线程完成任务&quot;</span>);

        <span class="comment">/**</span>
<span class="comment">         * 用于阻塞式获取结果,如果想要异步获取结果,通常都会以轮询的方式去获取结果</span>
<span class="comment">         */</span>
        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;
            <span class="keyword">if</span> (futureTask.isDone()) &#123;
                System.out.println(futureTask.get());
                <span class="keyword">break</span>;
            &#125;
        &#125;
    &#125;
&#125;</code></pre>

<p><strong>结论：</strong>Future对于结果的获取不是很友好，只能通过阻塞或轮询的方式得到任务的结果。</p>
<h2 id="4-完成复杂的任务"><a href="#4-完成复杂的任务" class="headerlink" title="4. 完成复杂的任务"></a>4. 完成复杂的任务</h2><ul>
<li><p>回调通知（Future支持）</p>
<ul>
<li>应对Future的完成时间，完成了可以告诉我，也就是我们的回调通知</li>
<li>通过轮询的方式去判断任务是否完成这样非常占cpu并且代码也不优雅</li>
</ul>
</li>
<li><p>创建异步任务：Future+线程池组合</p>
<pre><code class="highlight java"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FutureTaskDemo4</span> &#123;
    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ExecutionException, InterruptedException &#123;
        <span class="comment">// 创建线程池</span>
        <span class="type">ExecutorService</span> <span class="variable">executorService</span> <span class="operator">=</span> Executors.newFixedThreadPool(<span class="number">5</span>);
        
        FutureTask&lt;String&gt; futureTask = <span class="keyword">new</span> <span class="title class_">FutureTask</span>&lt;&gt;(() -&gt; &#123;
            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;-----come in FutureTask&quot;</span>);
            <span class="keyword">try</span> &#123;
                TimeUnit.SECONDS.sleep(<span class="number">3</span>);
            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;
                e.printStackTrace();
            &#125;
            <span class="keyword">return</span> <span class="string">&quot;&quot;</span> + ThreadLocalRandom.current().nextInt(<span class="number">100</span>);
        &#125;);

        <span class="comment">// 异步提交任务</span>
        executorService.submit(futureTask);

        System.out.println(Thread.currentThread().getName() + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;线程完成任务&quot;</span>);

        <span class="comment">/**</span>
<span class="comment">         * 用于阻塞式获取结果,如果想要异步获取结果,通常都会以轮询的方式去获取结果</span>
<span class="comment">         */</span>
        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;
            <span class="keyword">if</span> (futureTask.isDone()) &#123;
                System.out.println(futureTask.get());
                <span class="keyword">break</span>;
            &#125;
        &#125;

        <span class="comment">// 关闭线程池</span>
        executorService.shutdown();
    &#125;
&#125;</code></pre>


</li>
<li><p>多个任务前后依赖可以组合处理（Future不支持）</p>
<ul>
<li>想将多个异步任务的结果组合起来，后一个异步任务的计算结果需要前一个异步任务的值</li>
<li>想将两个或多个异步计算合并成为一个异步计算，这几个异步计算互相独立，同时后面这个又依赖前一个处理的结果</li>
</ul>
</li>
<li><p>对计算速度选最快的（Future不支持）</p>
<ul>
<li>当Future集合中某个任务最快结束时，返回结果，返回第一名处理结果</li>
</ul>
</li>
</ul>
<p><strong>结论</strong></p>
<ul>
<li>对于简单的业务场景使用 Future 完全 ok</li>
<li>对于复杂业务场景，使用 Future 之前提供的 API 处理起来不够优雅，这时候需要使用 CompletableFuture 以声明式的方式优雅的处理这些需求。</li>
<li>Future能干的，CompletableFuture 都能干</li>
</ul>
<h1 id="三、CompletableFuture对Future的改进"><a href="#三、CompletableFuture对Future的改进" class="headerlink" title="三、CompletableFuture对Future的改进"></a>三、CompletableFuture对Future的改进</h1><h2 id="1-CompletableFuture为什么会出现"><a href="#1-CompletableFuture为什么会出现" class="headerlink" title="1. CompletableFuture为什么会出现"></a>1. CompletableFuture为什么会出现</h2><ul>
<li>get() 方法在 Future 计算完成之前会一直处在阻塞状态下，阻塞的方式和异步编程的设计理念相违背。</li>
<li>isDone() 方法容易耗费 cpu 资源（cpu空转），</li>
<li>对于真正的异步处理我们希望是可以通过传入回调函数，在Future结束时自动调用该回调函数，这样，我们就不用等待结果</li>
</ul>
<p>jdk8 设计出 CompletableFuture，CompletableFuture 提供了一种观察者模式类似的机制，可以让任务执行完成后通知监听的一方。</p>
<h2 id="2-CompletableFuture-和-CompletionStage-介绍"><a href="#2-CompletableFuture-和-CompletionStage-介绍" class="headerlink" title="2. CompletableFuture 和 CompletionStage 介绍"></a>2. CompletableFuture 和 CompletionStage 介绍</h2><p><strong>类架构说明</strong>：</p>
<p><img src="https://raw.githubusercontent.com/GeorgeChan95/blogimg/master/img/2024/09/19/20240919-093123.png" alt="CompletableFuture"></p>
<p><img src="https://raw.githubusercontent.com/GeorgeChan95/blogimg/master/img/2024/09/19/20240919-093420.png" alt="CompletableFuture"></p>
<ul>
<li><strong>接口CompletionStage</strong><ul>
<li>代表异步计算过程中的某一个阶段，一个阶段完成以后可能会触发另外一个阶段。<ul>
<li>有些类似Linux系统的管道分隔符传参数</li>
</ul>
</li>
<li>一个阶段的执行可能是被单个阶段的完成触发，也可能是由多个阶段一起触发</li>
<li>一个阶段的计算执行可以是一个 function, Consumer 或者 Runnable。<ul>
<li>比如: <code>stage.thenApply(x -&gt; square(x).thenAccept(x -&gt; System.out.print(x)).thenRun(0)-&gt; system.out.println())</code></li>
</ul>
</li>
</ul>
</li>
<li><strong>类CompletableFuture</strong><ul>
<li>在Java8中，CompletableFuture 提供了非常强大的 Future 的扩展功能，可以帮助我们简化异步编程的复杂性，并且提供了函数式编程的能力，可以通过回调的方式处理计算结果，也提供了转换和组合 CompletableFuture 的方法,</li>
<li>它可能代表一个明确完成的 Future，也有可能代表一个完成阶段 (CompletionStage)，它支持在计算完成以后触发一些函数或执行某些动作。</li>
<li>它实现了 Future 和 CompletionStage 接口</li>
</ul>
</li>
</ul>
<h2 id="3-四个核心静态方法，创建异步任务"><a href="#3-四个核心静态方法，创建异步任务" class="headerlink" title="3. 四个核心静态方法，创建异步任务"></a>3. 四个核心静态方法，创建异步任务</h2><p>四个静态构造方法</p>
<p><img src="https://raw.githubusercontent.com/GeorgeChan95/blogimg/master/img/2024/09/19/20240919-094354.png" alt="CompletableFuture静态方法"></p>
<p><strong>对于上述Executor参数说明：若没有指定，则使用默认的 <code>ForkJoinPoolCommonPool()</code> 作为它的线程池执行异步代码，如果指定线程池，则使用我们自定义的或者特别指定的线程池执行异步代码</strong></p>
<h3 id="3-1-四个静态方法演示"><a href="#3-1-四个静态方法演示" class="headerlink" title="3.1 四个静态方法演示"></a>3.1 四个静态方法演示</h3><pre><code class="highlight java"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CompletableFutureBuildDemo</span> &#123;
    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ExecutionException, InterruptedException &#123;
        <span class="comment">// 自定义线程池</span>
        <span class="type">ThreadPoolExecutor</span> <span class="variable">threadPoolExecutor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>(
                <span class="number">1</span>,
                <span class="number">20</span>,
                <span class="number">1L</span>,
                TimeUnit.SECONDS,
                <span class="keyword">new</span> <span class="title class_">LinkedBlockingQueue</span>&lt;&gt;(<span class="number">50</span>),
                Executors.defaultThreadFactory(),
                <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>.AbortPolicy());


        <span class="comment">// 无返回值，默认线程池</span>
        CompletableFuture&lt;Void&gt; future1 = CompletableFuture.runAsync(() -&gt; &#123;
            <span class="keyword">try</span> &#123;
                TimeUnit.SECONDS.sleep(<span class="number">1</span>);
            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;
                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);
            &#125;
            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;无返回值，默认线程池：ForkJoinPool&quot;</span>);
        &#125;);
        System.out.println(<span class="string">&quot;future1 ==&gt; &quot;</span> + future1.get());
        <span class="comment">/*</span>
<span class="comment">        * 打印：</span>
<span class="comment">        ForkJoinPool.commonPool-worker-1无返回值，默认线程池：ForkJoinPool</span>
<span class="comment">        future1 ==&gt; null</span>
<span class="comment">        * */</span>
        System.out.println(<span class="string">&quot;----------------------------------------------------------&quot;</span>);

        <span class="comment">// 无返回值，自定义线程池</span>
        CompletableFuture&lt;Void&gt; future2 = CompletableFuture.runAsync(() -&gt; &#123;
            <span class="keyword">try</span> &#123;
                TimeUnit.SECONDS.sleep(<span class="number">1</span>);
            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;
                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);
            &#125;
            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;无返回值，自定义线程池&quot;</span>);
        &#125;, threadPoolExecutor);
        System.out.println(<span class="string">&quot;future2 ==&gt; &quot;</span> + future2.get());
        <span class="comment">/*</span>
<span class="comment">        * 打印：</span>
<span class="comment">        pool-1-thread-1无返回值，自定义线程池</span>
<span class="comment">        future2 ==&gt; null</span>
<span class="comment">        * */</span>
        System.out.println(<span class="string">&quot;----------------------------------------------------------&quot;</span>);

        CompletableFuture&lt;String&gt; future3 = CompletableFuture.supplyAsync(() -&gt; &#123;
            <span class="keyword">try</span> &#123;
                TimeUnit.SECONDS.sleep(<span class="number">1</span>);
            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;
                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);
            &#125;
            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;有返回值，默认线程池：ForkJoinPool&quot;</span>);
            <span class="keyword">return</span> <span class="string">&quot;有返回值，默认线程池：ForkJoinPool&quot;</span>;
        &#125;);
        System.out.println(<span class="string">&quot;future3 ==&gt; &quot;</span> + future3.get());
        <span class="comment">/*</span>
<span class="comment">        * 打印：</span>
<span class="comment">        ForkJoinPool.commonPool-worker-1有返回值，默认线程池：ForkJoinPool</span>
<span class="comment">        future3 ==&gt; 有返回值，默认线程池：ForkJoinPool</span>
<span class="comment">        * */</span>
        System.out.println(<span class="string">&quot;----------------------------------------------------------&quot;</span>);

        CompletableFuture&lt;String&gt; future4 = CompletableFuture.supplyAsync(() -&gt; &#123;
            <span class="keyword">try</span> &#123;
                TimeUnit.SECONDS.sleep(<span class="number">1</span>);
            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;
                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);
            &#125;
            System.out.println(Thread.currentThread().getName() + <span class="string">&quot;有返回值，自定义线程池&quot;</span>);
            <span class="keyword">return</span> <span class="string">&quot;有返回值，自定义线程池&quot;</span>;
        &#125;, threadPoolExecutor);
        System.out.println(<span class="string">&quot;future4 ==&gt; &quot;</span> + future4.get());
        <span class="comment">/*</span>
<span class="comment">        * 打印：</span>
<span class="comment">        pool-1-thread-1有返回值，自定义线程池</span>
<span class="comment">        future4 ==&gt; 有返回值，自定义线程池</span>
<span class="comment">        * */</span>

        <span class="comment">// 关闭线程池</span>
        threadPoolExecutor.shutdown();
    &#125;
&#125;</code></pre>



<h3 id="3-2-回调方法演示"><a href="#3-2-回调方法演示" class="headerlink" title="3.2 回调方法演示"></a>3.2 回调方法演示</h3><p>CompletableFuture 减少阻塞和轮询，可以传入回调对象，当异步任务完成或者发生异常时，自动调用回调对象的回调方法。</p>
<pre><code class="highlight java"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CompletableFutureUseDemo</span> &#123;
    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;
        <span class="comment">// 自定义线程池</span>
        <span class="type">ThreadPoolExecutor</span> <span class="variable">threadPoolExecutor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>(<span class="number">1</span>,
                <span class="number">20</span>,
                <span class="number">1</span>,
                TimeUnit.SECONDS,
                <span class="keyword">new</span> <span class="title class_">LinkedBlockingQueue</span>&lt;&gt;(<span class="number">5</span>),
                Executors.defaultThreadFactory(),
                <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>.AbortPolicy());

        CompletableFuture&lt;Integer&gt; completableFuture = CompletableFuture.supplyAsync(() -&gt; &#123;
            System.out.println(Thread.currentThread().getName() + <span class="string">&quot; 线程运行中...&quot;</span>);
            <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> ThreadLocalRandom.current().nextInt(<span class="number">10</span>);
            <span class="keyword">try</span> &#123;
                TimeUnit.SECONDS.sleep(<span class="number">1</span>);
            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;
                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);
            &#125;

            <span class="keyword">if</span> (result &gt; <span class="number">5</span>) &#123;
                <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">10</span> / <span class="number">0</span>;
            &#125;
            <span class="keyword">return</span> result;
        &#125;, threadPoolExecutor).whenComplete((v, e) -&gt; &#123; <span class="comment">// 当计算完成时调用</span>
            <span class="keyword">if</span> (e == <span class="literal">null</span>) &#123;
                System.out.println(Thread.currentThread().getName() + <span class="string">&quot; 线程计算完成，结果为：&quot;</span> + v);
            &#125;
        &#125;).exceptionally(e -&gt; &#123;
            e.printStackTrace();
            <span class="type">String</span> <span class="variable">msg</span> <span class="operator">=</span> String.format(<span class="string">&quot;%s 线程计算出现异常，原因：%s, 错误信息：%s&quot;</span>, Thread.currentThread().getName(), e.getCause(), e.getMessage());
            System.out.println(msg);
            <span class="keyword">return</span> -<span class="number">1</span>;
        &#125;);

        System.out.println(Thread.currentThread().getName() + <span class="string">&quot; 线程先去完成其他任务&quot;</span>);

        <span class="comment">// 线程不要立刻结束，否则CompletableFuture默认使用的线程池会立刻关闭：暂停3秒钟线程</span>
        TimeUnit.SECONDS.sleep(<span class="number">2</span>);
        <span class="comment">// 关闭自定义线程池</span>
        threadPoolExecutor.shutdown();
    &#125;
&#125;
<span class="comment">/*</span>
<span class="comment">无异常时打印如下：</span>
<span class="comment">pool-1-thread-1 线程运行中...</span>
<span class="comment">main 线程先去完成其他任务</span>
<span class="comment">pool-1-thread-1 线程计算完成，结果为：2</span>
<span class="comment">* */</span>

<span class="comment">/*</span>
<span class="comment">有异常时打印如下：</span>
<span class="comment">pool-1-thread-1 线程运行中...</span>
<span class="comment">main 线程先去完成其他任务</span>
<span class="comment">java.util.concurrent.CompletionException: java.lang.ArithmeticException: / by zero</span>
<span class="comment">	at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:315)</span>
<span class="comment">	at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:320)</span>
<span class="comment">	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1770)</span>
<span class="comment">	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)</span>
<span class="comment">	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)</span>
<span class="comment">	at java.base/java.lang.Thread.run(Thread.java:842)</span>
<span class="comment">Caused by: java.lang.ArithmeticException: / by zero</span>
<span class="comment">	at com.atguigu.juc.cf.CompletableFutureUseDemo.lambda$main$0(CompletableFutureUseDemo.java:32)</span>
<span class="comment">	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1768)</span>
<span class="comment">	... 3 more</span>
<span class="comment">pool-1-thread-1 线程计算出现异常，原因：java.lang.ArithmeticException: / by zero, 错误信息：java.lang.ArithmeticException: / by zero</span>
<span class="comment">* */</span></code></pre>

<p>CompletableFuture优点：</p>
<ul>
<li>异步任务<strong>结束</strong>时，会自动回调某个对象的方法</li>
<li>主线程设置好回调后，不用关心异步任务的执行，异步任务之间可以顺序执行</li>
<li>异步任务<strong>出错</strong>时，会自动回调某个对象的方法</li>
</ul>
<h1 id="四、函数式编程"><a href="#四、函数式编程" class="headerlink" title="四、函数式编程"></a>四、函数式编程</h1><p>Lambda表达式+Stream流式调用+Chain链式调用+Java8函数式编程</p>
<h2 id="1-函数式接口"><a href="#1-函数式接口" class="headerlink" title="1. 函数式接口"></a>1. 函数式接口</h2><ul>
<li><p>Runnable：无参数、无返回值</p>
<p><img src="https://raw.githubusercontent.com/GeorgeChan95/blogimg/master/img/2024/09/19/20240919-110244.png" alt="Runnable"></p>
</li>
<li><p>Function：接受一个参数，并且有返回值</p>
<p><img src="https://raw.githubusercontent.com/GeorgeChan95/blogimg/master/img/2024/09/19/20240919-110317.png" alt="Function"></p>
</li>
<li><p>Consumer：接受一个参数，没有返回值</p>
<p><img src="https://raw.githubusercontent.com/GeorgeChan95/blogimg/master/img/2024/09/19/20240919-110409.png" alt="Consumer"></p>
</li>
<li><p>BiConsumer：接受两个参数，没有返回值</p>
<p><img src="https://raw.githubusercontent.com/GeorgeChan95/blogimg/master/img/2024/09/19/20240919-110436.png" alt="BiConsumer"></p>
</li>
<li><p>Supplier：没有参数，有返回值</p>
<p><img src="https://raw.githubusercontent.com/GeorgeChan95/blogimg/master/img/2024/09/19/20240919-110455.png" alt="Supplier"></p>
</li>
</ul>
<p><strong>总结：</strong></p>
<table>
<thead>
<tr>
<th>函数式接口名称</th>
<th>方法名称</th>
<th>参数</th>
<th>返回值</th>
</tr>
</thead>
<tbody><tr>
<td>Runnable</td>
<td>run</td>
<td>无参数</td>
<td>无返回值</td>
</tr>
<tr>
<td>Function</td>
<td>apply</td>
<td>1个参数</td>
<td>有返回值</td>
</tr>
<tr>
<td>Consume</td>
<td>accept</td>
<td>1个参数</td>
<td>无返回值</td>
</tr>
<tr>
<td>Supplier</td>
<td>get</td>
<td>没有参数</td>
<td>有返回值</td>
</tr>
<tr>
<td>Biconsumer</td>
<td>accept</td>
<td>2个参数</td>
<td>无返回值</td>
</tr>
</tbody></table>
<h2 id="2-链式编程"><a href="#2-链式编程" class="headerlink" title="2. 链式编程"></a>2. 链式编程</h2><pre><code class="highlight java"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Chain</span> &#123;
    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;
        <span class="comment">//-------------------老式写法------------</span>
<span class="comment">//        Student student = new Student();</span>
<span class="comment">//        student.setId(1);</span>
<span class="comment">//        student.setMajor(&quot;cs&quot;);</span>
<span class="comment">//        student.setName(&quot;小卡&quot;);</span>
        <span class="keyword">new</span> <span class="title class_">Student</span>().setId(<span class="number">1</span>).setName(<span class="string">&quot;大卡&quot;</span>).setMajor(<span class="string">&quot;cs&quot;</span>);
    &#125;
    
&#125;

<span class="meta">@NoArgsConstructor</span>
<span class="meta">@AllArgsConstructor</span>
<span class="meta">@Data</span>
<span class="meta">@Accessors(chain = true)</span><span class="comment">//开启链式编程</span>
<span class="keyword">class</span> <span class="title class_">Student</span>&#123;
    <span class="keyword">private</span> <span class="type">int</span> id;
    <span class="keyword">private</span> String name;
    <span class="keyword">private</span> String major;
&#125;</code></pre>





<h1 id="五、join-和-get-对比"><a href="#五、join-和-get-对比" class="headerlink" title="五、join 和 get 对比"></a>五、join 和 get 对比</h1><p>join 与 get 功能几乎一样，区别在于编码时是否需要抛出异常</p>
<ul>
<li>get() 方法需要抛出异常</li>
<li>join() 方法不需要抛出异常</li>
</ul>
<pre><code class="highlight java"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Chain</span> &#123;
    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ExecutionException, InterruptedException &#123; <span class="comment">//抛出异常</span>
        CompletableFuture&lt;String&gt; completableFuture = CompletableFuture.supplyAsync(() -&gt; &#123;
            <span class="keyword">return</span> <span class="string">&quot;hello 12345&quot;</span>;
        &#125;);
        System.out.println(completableFuture.get());
    &#125;

&#125;

<span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Chain</span> &#123;
    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>  &#123;<span class="comment">// 不用抛出异常</span>
        CompletableFuture&lt;String&gt; completableFuture = CompletableFuture.supplyAsync(() -&gt; &#123;
            <span class="keyword">return</span> <span class="string">&quot;hello 12345&quot;</span>;
        &#125;);
        System.out.println(completableFuture.join());
    &#125;
&#125;</code></pre>





<h1 id="六、CompletableFuture-案例讲解"><a href="#六、CompletableFuture-案例讲解" class="headerlink" title="六、CompletableFuture 案例讲解"></a>六、CompletableFuture 案例讲解</h1><h2 id="1-需求说明"><a href="#1-需求说明" class="headerlink" title="1. 需求说明"></a>1. 需求说明</h2><p>电商网站比价需求分析：</p>
<ol>
<li><p>需求说明：</p>
</li>
<li><ol>
<li>同一款产品，同时搜索出同款产品在各大电商平台的售价</li>
<li>同一款产品，同时搜索出本产品在同一个电商平台下，各个入驻卖家售价是多少</li>
</ol>
</li>
<li><p>输出返回：</p>
</li>
<li><ol>
<li>出来结果希望是同款产品的在不同地方的价格清单列表，返回一个List<String></li>
</ol>
</li>
</ol>
<p>例如：《Mysql》 in jd price is 88.05  《Mysql》 in taobao price is 90.43</p>
<ol>
<li><p>解决方案，对比同一个产品在各个平台上的价格，要求获得一个清单列表</p>
</li>
<li><ol>
<li>step by step，按部就班，查完淘宝查京东，查完京东查天猫….</li>
<li>all in，万箭齐发，一口气多线程异步任务同时查询</li>
</ol>
</li>
</ol>
<h2 id="2-不使用多线程实现需求"><a href="#2-不使用多线程实现需求" class="headerlink" title="2. 不使用多线程实现需求"></a>2. 不使用多线程实现需求</h2><p>从不同的网站逐个查询，直到所有网站查询完成，返回结果。</p>
<pre><code class="highlight java"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NetMallCase</span> &#123;

    <span class="keyword">static</span> List&lt;NetMall&gt; list = Arrays.asList(
            <span class="keyword">new</span> <span class="title class_">NetMall</span>(<span class="string">&quot;jd&quot;</span>),
            <span class="keyword">new</span> <span class="title class_">NetMall</span>(<span class="string">&quot;pdd&quot;</span>),
            <span class="keyword">new</span> <span class="title class_">NetMall</span>(<span class="string">&quot;taobao&quot;</span>),
            <span class="keyword">new</span> <span class="title class_">NetMall</span>(<span class="string">&quot;dangdangwang&quot;</span>),
            <span class="keyword">new</span> <span class="title class_">NetMall</span>(<span class="string">&quot;tmall&quot;</span>)
    );

    <span class="comment">/**</span>
<span class="comment">     * 不使用多线程，获取图书在不同平台的价格</span>
<span class="comment">     * <span class="doctag">@param</span> list</span>
<span class="comment">     * <span class="doctag">@param</span> productName</span>
<span class="comment">     * <span class="doctag">@return</span></span>
<span class="comment">     */</span>
    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;String&gt; <span class="title function_">getPriceByStep</span><span class="params">(List&lt;NetMall&gt; list, String productName)</span> &#123;
        List&lt;String&gt; result = list.stream().map(netMall -&gt; &#123;
            <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> String.format(productName + <span class="string">&quot; in %s price is %.2f&quot;</span>, netMall.getMallName(), netMall.calcPrice(productName));
            <span class="keyword">return</span> str;
        &#125;).collect(Collectors.toList());
        <span class="keyword">return</span> result;
    &#125;

    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;
        <span class="type">long</span> <span class="variable">startTime</span> <span class="operator">=</span> System.currentTimeMillis();
        List&lt;String&gt; resuts = getPriceByStep(list, <span class="string">&quot;mysql&quot;</span>);
        <span class="keyword">for</span> (String data : resuts) &#123;
            System.out.println(data);
        &#125;
        <span class="type">long</span> <span class="variable">endTime</span> <span class="operator">=</span> System.currentTimeMillis();
        System.out.println(<span class="string">&quot;不使用多线程，costTime: &quot;</span> + (endTime - startTime) + <span class="string">&quot; 毫秒&quot;</span>);
    &#125;

&#125;

<span class="keyword">class</span> <span class="title class_">NetMallData</span> &#123;
    <span class="meta">@Getter</span>
    <span class="keyword">private</span> String mallName;

    <span class="keyword">public</span> <span class="title function_">NetMallData</span><span class="params">(String mallName)</span> &#123;
        <span class="built_in">this</span>.mallName = mallName;
    &#125;

    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">calcPrice</span><span class="params">(String productName)</span> &#123;
        <span class="comment">//检索需要1秒钟</span>
        <span class="keyword">try</span> &#123;
            TimeUnit.SECONDS.sleep(<span class="number">1</span>);
        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;
            e.printStackTrace();
        &#125;
        <span class="keyword">return</span> ThreadLocalRandom.current().nextDouble() * <span class="number">2</span> + productName.charAt(<span class="number">0</span>);
    &#125;
&#125;</code></pre>

<p>执行结果：</p>
<pre><code class="highlight shell">mysql in jd price is 109.95
mysql in pdd price is 109.86
mysql in taobao price is 109.79
mysql in dangdangwang price is 110.08
mysql in tmall price is 110.55
不使用多线程，costTime: 5070 毫秒</code></pre>

<p>多个查询逐个完成，执行效率低，执行时间长。</p>
<h2 id="3-使用-CompletableFuture-实现需求"><a href="#3-使用-CompletableFuture-实现需求" class="headerlink" title="3. 使用 CompletableFuture 实现需求"></a>3. 使用 CompletableFuture 实现需求</h2><pre><code class="highlight java"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NetMallCase</span> &#123;

    <span class="keyword">static</span> List&lt;NetMall&gt; list = Arrays.asList(
            <span class="keyword">new</span> <span class="title class_">NetMall</span>(<span class="string">&quot;jd&quot;</span>),
            <span class="keyword">new</span> <span class="title class_">NetMall</span>(<span class="string">&quot;pdd&quot;</span>),
            <span class="keyword">new</span> <span class="title class_">NetMall</span>(<span class="string">&quot;taobao&quot;</span>),
            <span class="keyword">new</span> <span class="title class_">NetMall</span>(<span class="string">&quot;dangdangwang&quot;</span>),
            <span class="keyword">new</span> <span class="title class_">NetMall</span>(<span class="string">&quot;tmall&quot;</span>)
    );

    <span class="comment">/**</span>
<span class="comment">     * 不使用多线程，获取图书在不同平台的价格</span>
<span class="comment">     *</span>
<span class="comment">     * <span class="doctag">@param</span> list</span>
<span class="comment">     * <span class="doctag">@param</span> productName</span>
<span class="comment">     * <span class="doctag">@return</span></span>
<span class="comment">     */</span>
    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;String&gt; <span class="title function_">getPriceByStep</span><span class="params">(List&lt;NetMall&gt; list, String productName)</span> &#123;
        List&lt;String&gt; result = list.stream().map(netMall -&gt; &#123;
            <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> String.format(productName + <span class="string">&quot; in %s price is %.2f&quot;</span>, netMall.getMallName(), netMall.calcPrice(productName));
            <span class="keyword">return</span> str;
        &#125;).collect(Collectors.toList());
        <span class="keyword">return</span> result;
    &#125;

    <span class="comment">/**</span>
<span class="comment">     * 使用多线程异步的从不同平台获取图书价格</span>
<span class="comment">     *</span>
<span class="comment">     * <span class="doctag">@param</span> list</span>
<span class="comment">     * <span class="doctag">@param</span> productName</span>
<span class="comment">     * <span class="doctag">@return</span></span>
<span class="comment">     */</span>
    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;String&gt; <span class="title function_">getPriceByAsync</span><span class="params">(List&lt;NetMall&gt; list, String productName)</span> &#123;
        List&lt;String&gt; results = list.stream().map(netMall -&gt;
                        CompletableFuture.supplyAsync(() -&gt; String.format(productName + <span class="string">&quot; in %s price is %.2f&quot;</span>, netMall.getMallName(), netMall.calcPrice(productName))))
                .collect(Collectors.toList())
                .stream()
                .map(CompletableFuture::join)
                .collect(Collectors.toList());
        <span class="keyword">return</span> results;
    &#125;

    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;
        <span class="comment">// 使用异步多线程获取</span>
        <span class="type">long</span> <span class="variable">startTime2</span> <span class="operator">=</span> System.currentTimeMillis();
        List&lt;String&gt; resuts2 = getPriceByAsync(list, <span class="string">&quot;mysql&quot;</span>);
        <span class="keyword">for</span> (String data : resuts2) &#123;
            System.out.println(data);
        &#125;
        <span class="type">long</span> <span class="variable">endTime2</span> <span class="operator">=</span> System.currentTimeMillis();
        System.out.println(<span class="string">&quot;使用异步多线程，costTime: &quot;</span> + (endTime2 - startTime2) + <span class="string">&quot; 毫秒&quot;</span>);
    &#125;

&#125;

<span class="keyword">class</span> <span class="title class_">NetMallData</span> &#123;
    <span class="meta">@Getter</span>
    <span class="keyword">private</span> String mallName;

    <span class="keyword">public</span> <span class="title function_">NetMallData</span><span class="params">(String mallName)</span> &#123;
        <span class="built_in">this</span>.mallName = mallName;
    &#125;

    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">calcPrice</span><span class="params">(String productName)</span> &#123;
        <span class="comment">//检索需要1秒钟</span>
        <span class="keyword">try</span> &#123;
            TimeUnit.SECONDS.sleep(<span class="number">1</span>);
        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;
            e.printStackTrace();
        &#125;
        <span class="keyword">return</span> ThreadLocalRandom.current().nextDouble() * <span class="number">2</span> + productName.charAt(<span class="number">0</span>);
    &#125;
&#125;</code></pre>

<p>执行结果：</p>
<pre><code class="highlight shell">mysql in jd price is 110.91
mysql in pdd price is 109.59
mysql in taobao price is 109.30
mysql in dangdangwang price is 110.85
mysql in tmall price is 110.67
使用异步多线程，costTime: 1056 毫秒</code></pre>

<p>使用异步多线程，执行效率大大提升。</p>
<h1 id="七、CompletableFuture-常用API"><a href="#七、CompletableFuture-常用API" class="headerlink" title="七、CompletableFuture 常用API"></a>七、CompletableFuture 常用API</h1><h2 id="1-获得结果和触发计算"><a href="#1-获得结果和触发计算" class="headerlink" title="1.获得结果和触发计算"></a>1.获得结果和触发计算</h2><ul>
<li><p>获取结果</p>
<ul>
<li><code>public T get()</code>  阻塞等待，直到得到返回结果</li>
<li><code>public T get(long timeout,TimeUnit unit)</code>  阻塞等待指定的时长，超时则报错：TimeOutException</li>
<li><code>public T join()</code>  类似于get()，区别在于不需要抛出异常</li>
<li><code>public T getNow(T valueIfAbsent)</code>  立即获取结果不阻塞<ul>
<li>计算完，返回计算完成后的结果</li>
<li>没算完，返回设定的valueAbsent(直接返回了备胎值xxx)</li>
</ul>
</li>
</ul>
</li>
<li><p>主动触发计算</p>
<ul>
<li><code>public boolean complete(T value)</code>  是否立即打断get()方法返回括号值<ul>
<li>(执行要2s，等待只有1s，所以还没执行完就被打断了。返回true表示打断了获取这个过程，直接返回了备胎值 complete；如果没打断，返回false 和原来的abc)</li>
</ul>
</li>
</ul>
<pre><code class="highlight java"><span class="comment">/**</span>
<span class="comment"> * 获得结果和触发计算</span>
<span class="comment"> *</span>
<span class="comment"> * <span class="doctag">@throws</span> InterruptedException</span>
<span class="comment"> * <span class="doctag">@throws</span> ExecutionException</span>
<span class="comment"> */</span>
<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">m1</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException, ExecutionException &#123;
    <span class="type">ThreadPoolExecutor</span> <span class="variable">threadPoolExecutor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>(<span class="number">1</span>, <span class="number">20</span>, <span class="number">1L</span>, TimeUnit.SECONDS, <span class="keyword">new</span> <span class="title class_">LinkedBlockingQueue</span>&lt;&gt;(<span class="number">50</span>), 	Executors.defaultThreadFactory(), <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>.AbortPolicy());

    CompletableFuture&lt;Integer&gt; future = CompletableFuture.supplyAsync(() -&gt; &#123;
        <span class="comment">//暂停几秒钟线程</span>
        <span class="comment">//暂停几秒钟线程</span>
        <span class="keyword">try</span> &#123;
            TimeUnit.SECONDS.sleep(<span class="number">2</span>);
        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;
            e.printStackTrace();
        &#125;
        <span class="keyword">return</span> <span class="number">1</span>;
    &#125;, threadPoolExecutor);

    <span class="comment">//System.out.println(future.get()); // 1</span>
    <span class="comment">//System.out.println(future.get(2L,TimeUnit.SECONDS)); // 1</span>
    <span class="comment">//暂停几秒钟线程</span>
    <span class="keyword">try</span> &#123;
        TimeUnit.SECONDS.sleep(<span class="number">1</span>);
    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;
        e.printStackTrace();
    &#125;
    <span class="comment">//System.out.println(future.getNow(9999));</span>

    System.out.println(future.complete(-<span class="number">44</span>) + <span class="string">&quot;\t&quot;</span> + future.get());
    
    <span class="comment">// 关闭线程池</span>
    threadPoolExecutor.shutdown();
&#125;</code></pre>

<p>打印结果：</p>
<pre><code class="highlight shell">true	-44</code></pre></li>
</ul>
<h2 id="2-对计算结果进行处理"><a href="#2-对计算结果进行处理" class="headerlink" title="2. 对计算结果进行处理"></a>2. 对计算结果进行处理</h2><ul>
<li><p><code>thenApply </code> 计算结果存在在依赖关系，使得线程串行化。因为依赖关系，所以一旦有异常，直接叫停。</p>
<pre><code class="highlight java"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">thenApplyDemo</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException &#123;
    <span class="type">ThreadPoolExecutor</span> <span class="variable">threadPoolExecutor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>(<span class="number">1</span>, <span class="number">20</span>, <span class="number">1L</span>, TimeUnit.SECONDS, <span class="keyword">new</span> <span class="title class_">LinkedBlockingQueue</span>&lt;&gt;(<span class="number">50</span>), Executors.defaultThreadFactory(), <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>.AbortPolicy());

    CompletableFuture&lt;Integer&gt; completableFuture = CompletableFuture.supplyAsync(() -&gt; &#123;
        <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> ThreadLocalRandom.current().nextInt(<span class="number">10</span>);
        <span class="keyword">try</span> &#123;
            TimeUnit.SECONDS.sleep(<span class="number">1</span>);
        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;
            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);
        &#125;

        <span class="keyword">if</span> (result &gt; <span class="number">5</span>) &#123;
            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">10</span> / <span class="number">0</span>;
        &#125;
        <span class="keyword">return</span> <span class="number">1</span>;
    &#125;, threadPoolExecutor).thenApply(data -&gt; data + <span class="number">2</span>).whenComplete((v, e) -&gt; &#123;
        <span class="keyword">if</span> (e == <span class="literal">null</span>) &#123;
            System.out.println(<span class="string">&quot;执行完成，结果：&quot;</span> + v);
        &#125;
    &#125;).exceptionally(e -&gt; &#123;
        e.printStackTrace();
        <span class="type">String</span> <span class="variable">msg</span> <span class="operator">=</span> String.format(<span class="string">&quot;执行出现异常，原因：%s, 异常信息：%s&quot;</span>, e.getCause(), e.getMessage());
        System.out.println(msg);
        <span class="keyword">return</span> -<span class="number">1</span>;
    &#125;);
    
    System.out.println(<span class="string">&quot;执行结束，结果：&quot;</span> + completableFuture.join());

    <span class="comment">// 关闭自定义线程池</span>
    threadPoolExecutor.shutdown();

    <span class="comment">// 主线程停留3秒</span>
    TimeUnit.SECONDS.sleep(<span class="number">3</span>);
&#125;</code></pre>

<p>正常执行结束打印：</p>
<pre><code class="highlight shell">执行完成，结果：3
执行结束，结果：3</code></pre>

<p>异常执行结束打印：</p>
<pre><code class="highlight shell">java.util.concurrent.CompletionException: java.lang.ArithmeticException: / by zero
	at java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:273)
	at java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:280)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1606)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
Caused by: java.lang.ArithmeticException: / by zero
	at com.atguigu.juc.cf.CompletableFutureDemo.lambda$thenApplyDemo$0(CompletableFutureDemo.java:27)
	at java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1604)
	... 3 more
执行出现异常，原因：java.lang.ArithmeticException: / by zero, 异常信息：java.lang.ArithmeticException: / by zero
执行结束，结果：-1</code></pre>


</li>
<li><p><code>handle </code> 类似于 thenApply，但是有异常的话仍然可以往下走一步。</p>
<pre><code class="highlight java"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">handleDemo</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException &#123;
    <span class="comment">// 自定义线程池</span>
    <span class="type">ThreadPoolExecutor</span> <span class="variable">threadPool</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>(
            <span class="number">4</span>,
            <span class="number">5</span>,
            <span class="number">50</span>,
            TimeUnit.SECONDS,
            <span class="keyword">new</span> <span class="title class_">LinkedBlockingQueue</span>&lt;&gt;(<span class="number">10</span>),
            Executors.defaultThreadFactory(),
            <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>.AbortPolicy());

    CompletableFuture.supplyAsync(() -&gt; &#123;
        <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> ThreadLocalRandom.current().nextInt(<span class="number">10</span>);
        <span class="keyword">try</span> &#123;
            TimeUnit.SECONDS.sleep(<span class="number">1</span>);
        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;
            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);
        &#125;

        <span class="keyword">if</span> (result &gt; <span class="number">5</span>) &#123;
            <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">10</span> / <span class="number">0</span>;
        &#125;
        <span class="keyword">return</span> <span class="number">10</span>;
    &#125;, threadPool).handle((v, e) -&gt; &#123;
        <span class="keyword">if</span> (e == <span class="literal">null</span>) &#123;
            System.out.println(<span class="string">&quot;handle1执行完成，结果：&quot;</span> + v);
        &#125; <span class="keyword">else</span> &#123;
            System.out.println(<span class="string">&quot;handle1执行异常&quot;</span>);
        &#125;
        <span class="keyword">return</span> v + <span class="number">1</span>;
    &#125;).handle((v, e) -&gt; &#123;
        <span class="keyword">if</span> (e == <span class="literal">null</span>) &#123;
            System.out.println(<span class="string">&quot;handle2执行完成，结果：&quot;</span> + v);
        &#125; <span class="keyword">else</span> &#123;
            System.out.println(<span class="string">&quot;handle2执行异常&quot;</span>);
        &#125;
        <span class="keyword">return</span> <span class="string">&quot;abc&quot;</span>;
    &#125;).handle((v, e) -&gt; &#123;
        <span class="keyword">if</span> (e == <span class="literal">null</span>) &#123;
            System.out.println(<span class="string">&quot;handle3执行完成，结果：&quot;</span> + v);
        &#125; <span class="keyword">else</span> &#123;
            System.out.println(<span class="string">&quot;handle3执行异常&quot;</span>);
        &#125;
        <span class="keyword">return</span> <span class="string">&quot;xyz&quot;</span>;
    &#125;).whenCompleteAsync((v, e) -&gt; &#123;
        <span class="keyword">if</span> (e == <span class="literal">null</span>) &#123;
            System.out.println(Thread.currentThread().getName() + <span class="string">&quot; whenComplete执行完成，结果：&quot;</span> + v);
        &#125;
    &#125;, threadPool).exceptionally(e -&gt; &#123;
        e.printStackTrace();
        <span class="type">String</span> <span class="variable">msg</span> <span class="operator">=</span> String.format(<span class="string">&quot;执行出现异常，原因：%s, 异常信息：%s&quot;</span>, e.getCause(), e.getMessage());
        System.out.println(msg);
        <span class="keyword">return</span> <span class="string">&quot;error&quot;</span>;
    &#125;);

    TimeUnit.SECONDS.sleep(<span class="number">5</span>);

    <span class="comment">// 关闭线程池</span>
    threadPool.shutdown();

&#125;</code></pre>

<p>正常执行结束打印：</p>
<pre><code class="highlight shell">handle1执行完成，结果：10
handle2执行完成，结果：11
whenComplete执行完成，结果：abc</code></pre>

<p>异常执行结束打印：</p>
<pre><code class="highlight shell">handle1执行异常
handle2执行异常
handle3执行完成，结果：abc
pool-1-thread-2 whenComplete执行完成，结果：xyz</code></pre>

<p><strong>注意：</strong>当 <code>supplyAsync</code> 方法执行异常时， 程序依然往下走，经过了 <code>handle1</code>、<code>handle2</code>、<code>handle3</code> ，而没有经过 <code>exceptionally</code> ，当 <code>handle3</code> 出现异常时（在<code>whenCompleteAsync</code> 上方的方法），才会经过 <code>exceptionally</code> 方法</p>
</li>
</ul>
<p><strong>thenApply 在实际工作中最常用</strong></p>
<h2 id="3-对计算结果进行消费"><a href="#3-对计算结果进行消费" class="headerlink" title="3. 对计算结果进行消费"></a>3. 对计算结果进行消费</h2><p>接收任务的处理结果，并消费处理，<strong>无返回结果|消费型函数式接口</strong>，之前的是Function</p>
<ul>
<li><p>thenAccept</p>
<ul>
<li>thenAccept(Consumer action)</li>
<li>任务A执行完执行B，B需要A的结果，但是任务B无返回值</li>
</ul>
<pre><code class="highlight java">System.out.println(CompletableFuture.supplyAsync(() -&gt; <span class="string">&quot;resultA&quot;</span>).thenAccept(r -&gt; System.out.println(r)).join());</code></pre>


</li>
<li><p>thenRun</p>
<ul>
<li>thenRun(Runnable runnable)</li>
<li>任务A执行完执行B，并且B不需要A的结果</li>
</ul>
<pre><code class="highlight java">System.out.println(CompletableFuture.supplyAsync(() -&gt; <span class="string">&quot;resultA&quot;</span>).thenRun(() -&gt; &#123;&#125;).join());</code></pre>


</li>
<li><p>thenApply</p>
<ul>
<li>thenApply(Function fn)</li>
<li>任务A执行完执行B，B需要A的结果，同时任务B有返回值</li>
</ul>
<pre><code class="highlight java">System.out.println(CompletableFuture.supplyAsync(() -&gt; <span class="string">&quot;resultA&quot;</span>).thenApply(resultA -&gt; resultA + <span class="string">&quot; resultB&quot;</span>).join());</code></pre></li>
</ul>
<p>示例代码：</p>
<pre><code class="highlight java"><span class="comment">/**</span>
<span class="comment"> * 对计算结果进行消费</span>
<span class="comment"> */</span>
<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">m3</span><span class="params">()</span> &#123;
    CompletableFuture.supplyAsync(() -&gt; &#123;
        <span class="keyword">return</span> <span class="number">1</span>;
    &#125;).thenApply(f -&gt; &#123;
        <span class="keyword">return</span> f + <span class="number">2</span>;
    &#125;).thenApply(f -&gt; &#123;
        <span class="keyword">return</span> f + <span class="number">3</span>;
    &#125;).thenAccept(r -&gt; System.out.println(r));

    <span class="comment">// 任务A执行完执行B，并且B不需要A的结果, 且B无返回值</span>
    System.out.println(CompletableFuture.supplyAsync(() -&gt; <span class="string">&quot;resultA&quot;</span>).thenRun(() -&gt; &#123;&#125;).join());

    <span class="comment">// 任务A执行完执行B，B需要A的结果，但是任务B无返回值</span>
    System.out.println(CompletableFuture.supplyAsync(() -&gt; <span class="string">&quot;resultA&quot;</span>).thenAccept(r -&gt; System.out.println(r)).join());

    <span class="comment">// 任务A执行完执行B，B需要A的结果，同时任务B有返回值</span>
    System.out.println(CompletableFuture.supplyAsync(() -&gt; <span class="string">&quot;resultA&quot;</span>).thenApply(resultA -&gt; resultA + <span class="string">&quot; resultB&quot;</span>).join());
&#125;</code></pre>



<h2 id="4-CompleteFuture和线程池说明（非常重要）"><a href="#4-CompleteFuture和线程池说明（非常重要）" class="headerlink" title="4. CompleteFuture和线程池说明（非常重要）"></a>4. CompleteFuture和线程池说明（非常重要）</h2><p>上面的几个方法都有普通版本和后面加<strong>Async</strong>的版本, 例如：<code>thenRun</code>、<code>thenRunAsync</code>、<code>thenApply</code>、<code>thenApplyAsync</code>、<code>whenComplete</code>、<code>whenCompleteAsync</code> ……</p>
<p>以 <code>thenRun</code>和<code>thenRunAsync</code>为例，有什么区别？</p>
<ul>
<li><p><code>thenRun</code> 没有传入自定义线程池，使用默认线程池 ForkJoinPool</p>
</li>
<li><p><code>thenRunAsync</code>可传入一个自定义线程池</p>
<ul>
<li>如果你执行第一个任务的时候，传入了一个自定义线程池，调用<code>thenRun</code>方法执行第二个任务的时候，则第二个任务和第一个任务是用同一个线程池。</li>
<li>调用<code>thenRunAsync</code>执行第二个任务的时候，则第一个任务使用的是你自己传入的线程池，第二个任务使用的是 <strong>ForkJoin线程池</strong></li>
</ul>
</li>
<li><p>特殊情况，任务处理太快，系统优化切换原则，直接使用main线程处理</p>
</li>
<li><p>thenRun 代码示例</p>
<pre><code class="highlight plaintext">private static void m7() throws InterruptedException &#123;
    ThreadPoolExecutor threadPoolExecutor = new ThreadPoolExecutor(1, 20, 1L, TimeUnit.SECONDS, new LinkedBlockingQueue&lt;&gt;(50), Executors.defaultThreadFactory(), new ThreadPoolExecutor.AbortPolicy());
    CompletableFuture&lt;Void&gt; completableFuture = CompletableFuture.supplyAsync(()-&gt;&#123;
        try &#123;TimeUnit.MILLISECONDS.sleep(20);&#125; catch (InterruptedException e) &#123;e.printStackTrace();&#125;
        System.out.println(&quot;1号任务&quot;+&quot;\t&quot;+Thread.currentThread().getName());
        return &quot;abcd&quot;;
    &#125;,threadPoolExecutor).thenRun(()-&gt;&#123;
        try &#123;TimeUnit.MILLISECONDS.sleep(20);&#125; catch (InterruptedException e) &#123;e.printStackTrace();&#125;
        System.out.println(&quot;2号任务&quot;+&quot;\t&quot;+Thread.currentThread().getName());
    &#125;).thenRun(()-&gt;&#123;
        try &#123;TimeUnit.MILLISECONDS.sleep(20);&#125; catch (InterruptedException e) &#123;e.printStackTrace();&#125;
        System.out.println(&quot;3号任务&quot;+&quot;\t&quot;+Thread.currentThread().getName());
    &#125;).thenRun(()-&gt;&#123;
        try &#123;TimeUnit.MILLISECONDS.sleep(20);&#125; catch (InterruptedException e) &#123;e.printStackTrace();&#125;
        System.out.println(&quot;4号任务&quot;+&quot;\t&quot;+Thread.currentThread().getName());
    &#125;);

    Thread.sleep(2000);
    threadPoolExecutor.shutdown();
&#125;</code></pre>

<p>  运行结果：</p>
<pre><code class="highlight shell">1号任务	pool-1-thread-1
2号任务	pool-1-thread-1
3号任务	pool-1-thread-1
4号任务	pool-1-thread-1</code></pre>


</li>
<li><p>thenRunAsync 代码示例</p>
<pre><code class="highlight java"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">m7</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException &#123;
    <span class="type">ThreadPoolExecutor</span> <span class="variable">threadPoolExecutor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>(<span class="number">1</span>, <span class="number">20</span>, <span class="number">1L</span>, TimeUnit.SECONDS, <span class="keyword">new</span> <span class="title class_">LinkedBlockingQueue</span>&lt;&gt;(<span class="number">50</span>), Executors.defaultThreadFactory(), <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>.AbortPolicy());
    CompletableFuture&lt;Void&gt; completableFuture = CompletableFuture.supplyAsync(()-&gt;&#123;
        <span class="keyword">try</span> &#123;TimeUnit.MILLISECONDS.sleep(<span class="number">20</span>);&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;e.printStackTrace();&#125;
        System.out.println(<span class="string">&quot;1号任务&quot;</span>+<span class="string">&quot;\t&quot;</span>+Thread.currentThread().getName());
        <span class="keyword">return</span> <span class="string">&quot;abcd&quot;</span>;
    &#125;,threadPoolExecutor).thenRunAsync(()-&gt;&#123;
        <span class="keyword">try</span> &#123;TimeUnit.MILLISECONDS.sleep(<span class="number">20</span>);&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;e.printStackTrace();&#125;
        System.out.println(<span class="string">&quot;2号任务&quot;</span>+<span class="string">&quot;\t&quot;</span>+Thread.currentThread().getName());
    &#125;).thenRun(()-&gt;&#123;
        <span class="keyword">try</span> &#123;TimeUnit.MILLISECONDS.sleep(<span class="number">20</span>);&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;e.printStackTrace();&#125;
        System.out.println(<span class="string">&quot;3号任务&quot;</span>+<span class="string">&quot;\t&quot;</span>+Thread.currentThread().getName());
    &#125;).thenRun(()-&gt;&#123;
        <span class="keyword">try</span> &#123;TimeUnit.MILLISECONDS.sleep(<span class="number">20</span>);&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;e.printStackTrace();&#125;
        System.out.println(<span class="string">&quot;4号任务&quot;</span>+<span class="string">&quot;\t&quot;</span>+Thread.currentThread().getName());
    &#125;);

    Thread.sleep(<span class="number">2000</span>);
    threadPoolExecutor.shutdown();
&#125;</code></pre>

<p>运行结果：</p>
<pre><code class="highlight shell">1号任务	pool-1-thread-1
2号任务	ForkJoinPool.commonPool-worker-25
3号任务	ForkJoinPool.commonPool-worker-25
4号任务	ForkJoinPool.commonPool-worker-25</code></pre>


</li>
<li><p>特殊情况, 直接使用main线程处理</p>
<pre><code class="highlight java"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">m7</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException &#123;
    <span class="type">ThreadPoolExecutor</span> <span class="variable">threadPoolExecutor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>(<span class="number">1</span>, <span class="number">20</span>, <span class="number">1L</span>, TimeUnit.SECONDS, <span class="keyword">new</span> <span class="title class_">LinkedBlockingQueue</span>&lt;&gt;(<span class="number">50</span>), Executors.defaultThreadFactory(), <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>.AbortPolicy());
    CompletableFuture&lt;Void&gt; completableFuture = CompletableFuture.supplyAsync(()-&gt;&#123;
<span class="comment">//        try &#123;TimeUnit.MILLISECONDS.sleep(20);&#125; catch (InterruptedException e) &#123;e.printStackTrace();&#125;</span>
        System.out.println(<span class="string">&quot;1号任务&quot;</span>+<span class="string">&quot;\t&quot;</span>+Thread.currentThread().getName());
        <span class="keyword">return</span> <span class="string">&quot;abcd&quot;</span>;
    &#125;,threadPoolExecutor).thenRunAsync(()-&gt;&#123;
<span class="comment">//        try &#123;TimeUnit.MILLISECONDS.sleep(20);&#125; catch (InterruptedException e) &#123;e.printStackTrace();&#125;</span>
        System.out.println(<span class="string">&quot;2号任务&quot;</span>+<span class="string">&quot;\t&quot;</span>+Thread.currentThread().getName());
    &#125;).thenRun(()-&gt;&#123;
<span class="comment">//        try &#123;TimeUnit.MILLISECONDS.sleep(20);&#125; catch (InterruptedException e) &#123;e.printStackTrace();&#125;</span>
        System.out.println(<span class="string">&quot;3号任务&quot;</span>+<span class="string">&quot;\t&quot;</span>+Thread.currentThread().getName());
    &#125;).thenRun(()-&gt;&#123;
<span class="comment">//        try &#123;TimeUnit.MILLISECONDS.sleep(20);&#125; catch (InterruptedException e) &#123;e.printStackTrace();&#125;</span>
        System.out.println(<span class="string">&quot;4号任务&quot;</span>+<span class="string">&quot;\t&quot;</span>+Thread.currentThread().getName());
    &#125;);

    Thread.sleep(<span class="number">2000</span>);
    threadPoolExecutor.shutdown();
&#125;</code></pre>

<p> 运行结果：</p>
<pre><code class="highlight shell">1号任务	pool-1-thread-1
2号任务	ForkJoinPool.commonPool-worker-25
3号任务	main
4号任务	main</code></pre></li>
</ul>
<h2 id="5-对计算速度进行选用"><a href="#5-对计算速度进行选用" class="headerlink" title="5. 对计算速度进行选用"></a>5. 对计算速度进行选用</h2><ul>
<li>applyToEither 优先选择运行速度快的任务的结果</li>
</ul>
<pre><code class="highlight java"><span class="comment">/**</span>
<span class="comment"> * 对计算速度进行选用</span>
<span class="comment"> */</span>
<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">m4</span><span class="params">()</span> &#123;
    System.out.println(CompletableFuture.supplyAsync(() -&gt; &#123;
        <span class="comment">//暂停几秒钟线程</span>
        <span class="keyword">try</span> &#123;
            TimeUnit.SECONDS.sleep(<span class="number">1</span>);
        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;
            e.printStackTrace();
        &#125;
        <span class="keyword">return</span> <span class="number">1</span>;
    &#125;).applyToEither(CompletableFuture.supplyAsync(() -&gt; &#123;
        <span class="keyword">try</span> &#123;
            TimeUnit.SECONDS.sleep(<span class="number">2</span>);
        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;
            e.printStackTrace();
        &#125;
        <span class="keyword">return</span> <span class="number">2</span>;
    &#125;), r -&gt; &#123;
        <span class="keyword">return</span> r;
    &#125;).join());

    <span class="comment">//暂停几秒钟线程</span>
    <span class="keyword">try</span> &#123;
        TimeUnit.SECONDS.sleep(<span class="number">3</span>);
    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;
        e.printStackTrace();
    &#125;
&#125;</code></pre>

<p>运行结果：</p>
<pre><code class="highlight shell">1</code></pre>



<h2 id="6-对计算结果进行合并"><a href="#6-对计算结果进行合并" class="headerlink" title="6. 对计算结果进行合并"></a>6. 对计算结果进行合并</h2><ul>
<li><p><code>thenCombine</code> 合并</p>
<ul>
<li>两个 <code>CompletionStage</code> 任务都完成后，最终能把两个任务的结果一起交给 <code>thenCombine</code> 来处理</li>
<li>先完成的先等着，等待其它分支任务</li>
</ul>
<pre><code class="highlight java"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">m5</span><span class="params">()</span> <span class="keyword">throws</span> ExecutionException, InterruptedException &#123;
    CompletableFuture&lt;Integer&gt; thenCombineResult = CompletableFuture.supplyAsync(() -&gt; &#123;
        System.out.println(Thread.currentThread().getName() + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;---come in 1&quot;</span>);
        <span class="keyword">return</span> <span class="number">10</span>;
    &#125;).thenCombine(CompletableFuture.supplyAsync(() -&gt; &#123;
        System.out.println(Thread.currentThread().getName() + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;---come in 2&quot;</span>);
        <span class="keyword">return</span> <span class="number">20</span>;
    &#125;), (x, y) -&gt; &#123;
        System.out.println(Thread.currentThread().getName() + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;---come in 3&quot;</span>);
        <span class="keyword">return</span> x + y;
    &#125;).thenCombine(CompletableFuture.supplyAsync(() -&gt; &#123;
        System.out.println(Thread.currentThread().getName() + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;---come in 4&quot;</span>);
        <span class="keyword">return</span> <span class="number">30</span>;
    &#125;), (a, b) -&gt; &#123;
        System.out.println(Thread.currentThread().getName() + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;---come in 5&quot;</span>);
        <span class="keyword">return</span> a + b;
    &#125;);
    System.out.println(<span class="string">&quot;-----主线程结束，END&quot;</span>);
    System.out.println(thenCombineResult.get());


    <span class="comment">// 主线程不要立刻结束，否则CompletableFuture默认使用的线程池会立刻关闭:</span>
    <span class="keyword">try</span> &#123;
        TimeUnit.SECONDS.sleep(<span class="number">10</span>);
    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;
        e.printStackTrace();
    &#125;

&#125;</code></pre>

<p>打印结果：</p>
<pre><code class="highlight shell">ForkJoinPool.commonPool-worker-25	---come in 1
ForkJoinPool.commonPool-worker-25	---come in 2
main	---come in 3
ForkJoinPool.commonPool-worker-18	---come in 4
main	---come in 5
-----主线程结束，END
60</code></pre></li>
</ul>

      
       <hr><span style="font-style: italic;color: gray;"> 转载请注明来源，欢迎对文章中的引用来源进行考证，欢迎指出任何有错误或不够清晰的表达。可以在下面评论区评论，也可以邮件至 george_95@126.com </span>
    </div>
</article>





    <div id="comments"></div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">

<script type="text/javascript">
    $.getScript('/js/gitalk.js', function () {
        var gitalk = new Gitalk({
            clientID: 'f820fe811764cacedc4f',
            clientSecret: '0ce07abb65f0e79ddb8830f32029b8a9656e0ee0',
            repo: 'georgechan95.github.io',
            owner: 'GeorgeChan95',
            admin: ['GeorgeChan95'],
            id: decodeURI(location.pathname),
            distractionFreeMode: 'true',
            language: 'zh-CN',
            perPage: parseInt('15',10)
        })
        gitalk.render('comments')
    })
</script>




    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    ©2016-2020 George
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="切换全屏 快捷键 s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        

        /*高亮代码块行号*/
        

        /*访问数量*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*打赏页面隐藏与展示*/
    

</script>

<!--加入行号的高亮代码块样式-->

<!--自定义样式设置-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*列表样式*/
    

    /* 背景图样式 */
    
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    

    
    #post .pjax article :not(pre) > code {
        color: #24292e;
        font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;
        background-color: rgba(27,31,35,.05);
        border-radius: 3px;
        font-size: 85%;
        margin: 0;
        padding: .2em .4em;
    }
    
</style>







</html>
